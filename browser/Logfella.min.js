(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Logfella=e()}})(function(){var e,t,r;return function n(e,t,r){function i(s,a){if(!t[s]){if(!e[s]){var l=typeof require=="function"&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[s]={exports:{}};e[s][0].call(c.exports,function(t){var r=e[s][1][t];return i(r?r:t)},c,c.exports,n,e,t,r)}return t[s].exports}var o=typeof require=="function"&&require;for(var s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,r){"use strict";var n=e("logfella-common-transport");function i(){throw new Error("[logger] Cannot create a BrowserConsoleTransport object directly")}t.exports=i;i.prototype=Object.create(n.prototype);i.prototype.constructor=i;i.create=function o(e,t){var r=Object.create(i.prototype);r.init(e,t);return r};i.prototype.init=function s(e,t){if(t===null||typeof t!=="object"){t={}}n.prototype.init.call(this,e,t);Object.defineProperties(this,{color:{value:false,enumerable:true},indent:{value:t.indent===undefined?true:!!t.indent,writable:true,enumerable:true},includeIdMeta:{value:!!t.includeIdMeta,writable:true,enumerable:true},includeCommonMeta:{value:t.includeCommonMeta===undefined?true:!!t.includeCommonMeta,writable:true,enumerable:true},includeUserMeta:{value:t.includeUserMeta===undefined?true:!!t.includeUserMeta,writable:true,enumerable:true}})};i.prototype.transport=function a(e,t,r){console.log(this.messageFormatter(e,t)+"\n");r()}},{"logfella-common-transport":18}],2:[function(e,t,r){(function(r){"use strict";var n=e("async-kit");var i=e("string-kit");var o=e("logfella-common-transport");var s=e("util");var a,l,u=e("kung-fig");var c;if(r.browser){c=Date.now();if(r.uptime!=="function"){r.uptime=function v(){return Date.now()-c}}}else{a=e("path");l=e("os");u=e("kung-fig")}function f(){throw new Error("[logger] Cannot create a Logfella object directly")}t.exports=f;f.prototype.timeFormatter=e("./timeFormatter.js");f.prototype.messageFormatter=e("./messageFormatter.js");function p(){}var h={},d=["trace","debug","verbose","info","warning","error","fatal"],g=[];f.create=function x(e){var t=Object.create(f.prototype,{logTransports:{value:[],writable:true,enumerable:true},monTransports:{value:[],writable:true,enumerable:true},app:{value:null,writable:true,enumerable:true},pid:{value:null,writable:true,enumerable:true},hostname:{value:null,writable:true,enumerable:true},minLevel:{value:3,writable:true,enumerable:true},maxLevel:{value:6,writable:true,enumerable:true},defaultDomain:{value:"no-domain",writable:true,enumerable:true},overrideConsole:{value:false,writable:true,enumerable:true},levelArray:{value:d,writable:true,enumerable:true},levelHash:{value:h,writable:true,enumerable:true},mon:{value:{warnings:0,errors:0},writable:true,enumerable:true},monPeriod:{value:null,writable:true,enumerable:true}});Object.defineProperty(t,"root",{value:t});if(!r.browser){t.app=a.basename(r.argv[1]);t.pid=r.pid;t.hostname=l.hostname()}if(e){t.setGlobalConfig(e)}return t};(function(){var e,t;function r(e,t){f.prototype[t]=function(){var t;if(e<this.minLevel||e>this.maxLevel){t=arguments[arguments.length-1];if(typeof t==="function"){t()}return}return this.log.apply(this,[e].concat(Array.prototype.slice.call(arguments)))}}for(e=0;e<d.length;e++){t=d[e];h[t]=e;g.push(e);g.push(t);r(e,t)}})();f.prototype.use=function w(e){var t=Object.create(this,{domain:{value:e,enumerable:true}});return t};f.prototype.setGlobalConfig=function k(e){var t,r;if(e.app){this.app=e.app}if(e.minLevel!==undefined){if(typeof e.minLevel==="number"){this.minLevel=e.minLevel}else if(typeof e.minLevel==="string"){this.minLevel=this.levelHash[e.minLevel]}}if(e.maxLevel!==undefined){if(typeof e.maxLevel==="number"){this.maxLevel=e.maxLevel}else if(typeof e.maxLevel==="string"){this.maxLevel=this.levelHash[e.maxLevel]}}if(e.defaultDomain&&typeof e.defaultDomain==="string"){this.defaultDomain=e.defaultDomain}if(e.overrideConsole!==undefined){e.overrideConsole=!!e.overrideConsole;if(this.overrideConsole!==e.overrideConsole){if(e.overrideConsole){this.replaceConsole()}else{this.restoreConsole()}}this.overrideConsole=e.overrideConsole}if(e.monPeriod!==undefined){if(!e.monPeriod){this.monPeriod=null;this.stopMon()}else if(typeof e.monPeriod==="number"){this.monPeriod=e.monPeriod;this.startMon()}}if(Array.isArray(e.transports)){this.removeAllTransports();r=e.transports.length;for(t=0;t<r;t++){this.addTransport(e.transports[t].type,e.transports[t])}}};f.prototype.startMon=function j(){var e=this;if(this.monTimer){return}this.monTimer=setTimeout(function(){e.monTimer=null;e.monFrame(function(){e.startMon()})},this.monPeriod)};f.prototype.stopMon=function A(){if(this.monTimer){clearTimeout(this.monTimer);this.monTimer=null}};f.prototype.updateMon=function _(e){u.autoReduce(this.mon,e)};f.prototype.log=function C(e){var t,o,s,a,l,c,h,d,g={};t=arguments[arguments.length-1];if(typeof t!=="function"){t=p}if(typeof e==="number"){if(e<this.minLevel||e>this.maxLevel||e>=this.levelArray.length){t();return}l={level:e,levelName:this.levelArray[e]}}else if(typeof e==="string"){l={levelName:e,level:this.levelHash[e]};if(l.level===undefined||l.level<this.minLevel||l.level>this.maxLevel){t();return}}else{t();return}if(this.domain){l.domain=this.domain;a=1}else{l.domain=typeof arguments[1]==="string"?arguments[1]:this.defaultDomain;a=2}if(arguments.length>a+1&&typeof arguments[a+1]!=="function"){c=typeof arguments[a];if(arguments[a]&&c==="object"){l.meta=arguments[a];if("code"in l.meta){l.code=l.meta.code;delete l.meta.code}if("mon"in l.meta){d=l.meta.mon;delete l.meta.mon}a++}else if(c==="number"){l.code=arguments[a];a++}else if(c==="string"&&arguments[a].indexOf("%")===-1){l.code=arguments[a];a++}}if(l.level>=4){if(l.level>=5){this.mon.errors=+this.mon.errors+1||1}else{this.mon.warnings=+this.mon.warnings+1||1}}if(d&&typeof d==="object"){u.autoReduce(this.mon,d)}if(!this.logTransports.length){t();return}s=arguments[a];if(typeof s==="string"){o=i.format.count(s);if(!o){l.messageData=s}else{l.messageData=Array.prototype.slice.call(arguments,a,a+1+o);l.messageData.isFormat=true}}else{l.messageData=s}if(l.level===0&&!l.stack){if(r.browser){h=new Error}else{h={};Error.captureStackTrace(h,f.prototype.trace);if(h.stack.indexOf("\n")===-1){h={};Error.captureStackTrace(h,f.prototype.log)}}l.stack=h.stack}l.app=this.app;l.time=new Date;l.uptime=r.uptime();l.pid=this.pid;l.hostname=this.hostname;l.messageCache={};n.parallel(this.logTransports).using(function(t,r){if(e<t.minLevel||e>t.maxLevel){r();return}t.transport(l,g,r)}).exec(t)};f.prototype.monFrame=function T(e){if(!e){e=p}if(!this.monTransports.length){e();return}var t={};var i={level:null,levelName:"mon",app:this.app,domain:this.domain||"mon",time:new Date,uptime:r.uptime(),pid:this.pid,hostname:this.hostname,mon:this.mon};n.parallel(this.monTransports).using(function(e,r){e.transport(i,t,r)}).exec(e)};f.transports={};f.prototype.addTransport=function M(t,n){var s,a,l;switch(n.role){case"mon":a="monTransports";break;case"log":a="logTransports";break;default:a="logTransports";break}if(typeof t==="string"){t=t[0].toUpperCase()+t.slice(1);if(f.transports[t]===undefined&&!r.browser){try{s=e("./"+t+".transport.js")}catch(u){try{s=e("logfella-"+i.camelCaseToDashed(t)+"-transport")}catch(u){try{s=e("../../../package.json");if(s.name==="logfella-"+i.camelCaseToDashed(t)+"-transport"){s=e("../../../")}else{return}}catch(u){return}}}if(s.prototype instanceof o||typeof s.create==="function"&&typeof s.prototype.transport==="function"){f.transports[t]=s}else{return}}t=f.transports[t]}if(!t||typeof t.create!=="function"){return}try{l=t.create(this,n)}catch(u){return}this[a].push(l)};f.prototype.removeAllTransports=function O(){var e,t;for(e=0,t=this.logTransports.length;e<t;e++){this.logTransports[e].shutdown()}for(e=0,t=this.monTransports.length;e<t;e++){this.monTransports[e].shutdown()}this.logTransports=[];this.monTransports=[]};var b=false;if(r.browser){f.prototype.installExitHandlers=function E(){}}else{f.prototype.installExitHandlers=function I(){var e=this.root;var t=this.domain||"logfella";if(b){return}b=true;r.on("asyncExit",function(r,n,i){e.info(t,"The process is about to exit within %ims with code %i...",n,r,i)});r.on("exit",function(r){e.info(t,"The process is exiting with code %i...",r)});r.on("uncaughtException",function(i){if(r.listenerCount("uncaughtException")<=1){e.fatal(t,"Uncaught exception: %E",i,function(){n.exit(1)})}else{e.fatal(t,"Uncaught exception: %E",i)}});r.on("SIGINT",function(i){if(r.listenerCount("SIGINT")<=1){e.info(t,"Received a SIGINT signal.",function(){n.exit(130)})}else{e.info(t,"Received a SIGINT signal.")}});r.on("SIGTERM",function(i){if(r.listenerCount("SIGTERM")<=1){e.info(t,"Received a SIGTERM signal.",function(){n.exit(143)})}else{e.info(t,"Received a SIGTERM signal.")}});r.on("SIGHUP",function(i){if(r.listenerCount("SIGHUP")<=1){e.info(t,"Received a SIGHUP signal.",function(){n.exit(129)})}else{e.info(t,"Received a SIGHUP signal.")}})}}var y={trace:console.trace,log:console.log,info:console.info,warn:console.warn,error:console.error,dir:console.dir};var m;f.prototype.replaceConsole=function L(){console.trace=m.bind(this,"trace","console");console.log=m.bind(this,"info","console");console.info=m.bind(this,"info","console");console.warn=m.bind(this,"warning","console");console.error=m.bind(this,"error","console")};f.prototype.restoreConsole=function S(){console.trace=y.trace;console.log=y.log;console.info=y.info;console.warn=y.warn;console.error=y.error};function m(e,t){var r=i.escape.format(s.format.apply(undefined,Array.prototype.slice.call(arguments,2)));return this[e].apply(this,[t,r])}f.configSchema={type:"strictObject","default":{},properties:{minLevel:{"in":g,"default":3},maxLevel:{"in":g,"default":6},defaultDomain:{type:"string","default":"no-domain"},overrideConsole:{type:"boolean","default":false},monPeriod:{type:"number","default":null},transports:{type:"array","default":[],of:{type:"strictObject",extraProperties:true,properties:{type:{type:"string"},role:{"in":["log","mon"],"default":"log"},minLevel:{"in":g,"default":0},maxLevel:{"in":g,"default":6},messageFormatter:[{type:"function"},{type:"string",optional:true}],timeFormatter:[{type:"function"},{type:"string","default":"dateTime"}],color:{type:"boolean","default":false}}}}}};f.global=f.create();f.global.setGlobalConfig({minLevel:"trace"});if(r.browser){f.transports.BrowserConsole=e("./BrowserConsole.transport.js");f.global.addTransport("BrowserConsole",{minLevel:"trace"});window.Logfella=f}else{f.global.addTransport("console",{minLevel:"trace",color:true})}}).call(this,e("_process"))},{"../../../":undefined,"../../../package.json":undefined,"./BrowserConsole.transport.js":1,"./messageFormatter.js":3,"./timeFormatter.js":4,_process:14,"async-kit":5,"kung-fig":undefined,"logfella-common-transport":18,os:12,path:13,"string-kit":28,util:17}],3:[function(e,t,r){"use strict";var n=e("string-kit");var i=e("tree-kit");var o={},s={};i.extend({deep:true},s,n.format.default,{format:n.formatMethod,color:true});i.extend({deep:true},o,n.format.default,{format:n.formatMethod});delete o.markup;function a(e,t){var r,i="";if(e.mon){i="\n";if(t){for(r in e.mon){i+=n.ansi.green+r+n.ansi.reset+": "+n.ansi.cyan+e.mon[r]+n.ansi.reset+"\n"}}else{for(r in e.mon){i+=r+": "+e.mon[r]+"\n"}}}else if(Array.isArray(e.messageData)&&e.messageData.isFormat){i=n.formatMethod.apply(t?s:o,e.messageData)}else if(e.messageData instanceof Error){i=n.inspectError({style:t?"color":"none"},e.messageData)}else if(typeof e.messageData!=="string"){i=n.inspect({style:t?"color":"none"},e.messageData)}else{i=n.formatMethod.call(t?s:o,e.messageData)}return i}r.text=function l(e,t){var r,i,o,s="",l="",u="",c="",f="",p="",h="",d="",g="";o="text-"+(this.color?"c-":"!c-")+(this.indent?"i-":"!i-")+(this.includeIdMeta?"im-":"!im-")+(this.includeCommonMeta?"cm-":"!cm-")+(this.includeUserMeta?"um-":"!um-")+this.timeFormatter.name;if(t[o]){return t[o]}h=a(e,this.color);if(this.indent){h=h.replace(/\n/g,"\n    ")}if(this.includeCommonMeta){l=this.color?n.ansi.brightCyan+this.timeFormatter(e.time)+n.ansi.reset+" ":this.timeFormatter(e.time)+" ";if(e.domain&&typeof e.domain==="string"){u=this.color?n.ansi.magenta+"<"+e.domain+">"+n.ansi.reset+" ":"<"+e.domain+"> "}if(e.code!==undefined){f=this.color?n.ansi.green+"#"+e.code+n.ansi.reset+" ":"#"+e.code+" "}switch(e.levelName){case"trace":s=this.color?n.ansi.brightBlack+"[TRACE]"+n.ansi.reset+" ":"[TRACE] ";break;case"debug":s=this.color?n.ansi.dim+"[DEBUG]"+n.ansi.reset+" ":"[DEBUG] ";break;case"verbose":s=this.color?n.ansi.blue+"[VERB.]"+n.ansi.reset+" ":"[VERB.] ";break;case"info":s=this.color?n.ansi.brightWhite+"[INFO.]"+n.ansi.reset+" ":"[INFO.] ";break;case"warning":s=this.color?n.ansi.brightYellow+"[WARN.]"+n.ansi.reset+" ":"[WARN.] ";break;case"error":s=this.color?n.ansi.red+"[ERROR]"+n.ansi.reset+" ":"[ERROR] ";break;case"fatal":s=this.color?n.ansi.brightRed+n.ansi.bold+"[FATAL]"+n.ansi.reset+" ":"[FATAL] ";break;case"mon":s=this.color?n.ansi.cyan+"[ MON ]"+n.ansi.reset+" ":"[ MON ] ";break;default:s=this.color?n.ansi.dim+"["+(e.levelName+".    ").slice(0,5)+"]"+n.ansi.reset+" ":"["+(e.levelName+".    ").slice(0,5)+"] "}}if(this.includeIdMeta){c=this.color?n.ansi.yellow+e.hostname+n.ansi.brightBlack+"("+e.pid+")"+n.ansi.reset+" ":e.hostname+"("+e.pid+") "}if(this.includeUserMeta&&e.meta){p=JSON.stringify(e.meta);if(p==="{}"){p=""}else{p=this.color?n.ansi.blue+p+n.ansi.reset+" ":p+" "}}if(this.includeIdMeta||this.includeCommonMeta||this.includeUserMeta){g=this.color?n.ansi.brightBlack+"--"+n.ansi.reset+" ":"-- "}if("stack"in e){d="\n"+n.inspectStack({style:this.color?"color":"none"},e.stack)}h=s+l+c+u+f+p+g+h+d;t[o]=h;return h};r.json=function u(e,t){var r,n;r="json-"+(this.color?"c-":"!c-");if(t[r]){return t[r]}n=JSON.stringify({app:e.app,time:e.time.getTime(),uptime:e.uptime,pid:e.pid,hostname:e.hostname,domain:e.domain,level:e.level,levelName:e.levelName,code:e.code,mon:e.mon||undefined,meta:e.meta||undefined,messageData:e.mon?undefined:e.messageData,message:e.mon?undefined:a(e,this.color)});t[r]=n;return n}},{"string-kit":28,"tree-kit":36}],4:[function(e,t,r){"use strict";function n(e){return e>=10?e:"0"+e}r.dateTimeMs=function i(e){return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+" "+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)};r.dateTime=function o(e){return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+" "+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())};r.timeMs=function s(e){return n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)};r.time=function a(e){return n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())}},{}],5:[function(e,t,r){"use strict";var n=e("./core.js");t.exports=n;n.wrapper=e("./wrapper.js");n.exit=e("./exit.js")},{"./core.js":6,"./exit.js":7,"./wrapper.js":8}],6:[function(e,t,r){"use strict";var n=e("nextgen-events");var i=e("tree-kit/lib/extend.js");var o={};t.exports=o;o.AsyncError=function d(e){Error.call(this);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);this.message=e};o.AsyncError.prototype=Object.create(Error.prototype);o.AsyncError.prototype.constructor=o.AsyncError;o.Plan=function g(){throw new Error("[async] Cannot create an async Plan object directly")};o.Plan.prototype.constructor=o.Plan;var s={parallelLimit:{value:1,writable:true,enumerable:true,configurable:true},raceMode:{value:false,writable:true,enumerable:true,configurable:true},waterfallMode:{value:false,writable:true,enumerable:true,configurable:true},waterfallTransmitError:{value:false,writable:true,enumerable:true,configurable:true},whileAction:{value:undefined,writable:true,enumerable:true,configurable:true},whileActionBefore:{value:false,writable:true,enumerable:true,configurable:true},errorsAreFatal:{value:true,writable:true,enumerable:true,configurable:true},returnMapping1to1:{value:false,writable:true,enumerable:true,configurable:true},jobsData:{value:{},writable:true,enumerable:true},jobsKeys:{value:[],writable:true,enumerable:true},jobsUsing:{value:undefined,writable:true,enumerable:true},jobsTimeout:{value:undefined,writable:true,enumerable:true},returnLastJobOnly:{value:false,writable:true,enumerable:true},defaultAggregate:{value:undefined,writable:true,enumerable:true},returnAggregate:{value:false,writable:true,enumerable:true},transmitAggregate:{value:false,writable:true,enumerable:true},usingIsIterator:{value:false,writable:true,enumerable:true},thenAction:{value:undefined,writable:true,enumerable:true},catchAction:{value:undefined,writable:true,enumerable:true},finallyAction:{value:undefined,writable:true,enumerable:true},asyncEventNice:{value:-20,writable:true,enumerable:true},maxRetry:{value:0,writable:true,enumerable:true},retryTimeout:{value:0,writable:true,enumerable:true},retryMultiply:{value:1,writable:true,enumerable:true},retryMaxTimeout:{value:Infinity,writable:true,enumerable:true},execMappingMinInputs:{value:0,writable:true,enumerable:true},execMappingMaxInputs:{value:100,writable:true,enumerable:true},execMappingCallbacks:{value:["finally"],writable:true,enumerable:true},execMappingAggregateArg:{value:false,writable:true,enumerable:true},execMappingMinArgs:{value:0,writable:true,enumerable:true},execMappingMaxArgs:{value:101,writable:true,enumerable:true},execMappingSignature:{value:"( [finallyCallback] )",writable:true,enumerable:true},locked:{value:false,writable:true,enumerable:true}};o.do=function b(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.do(e);return t};o.parallel=function y(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{parallelLimit:{value:Infinity,writable:true,enumerable:true},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.do(e);return t};o.series=function m(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{parallelLimit:{value:1,enumerable:true},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.do(e);return t};o.race=function v(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{raceMode:{value:true,enumerable:true},parallelLimit:{value:Infinity,writable:true,enumerable:true},errorsAreFatal:{value:false,writable:true,enumerable:true},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.returnLastJobOnly=true;t.do(e);return t};o.waterfall=function x(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{waterfallMode:{value:true,enumerable:true},waterfallTransmitError:{value:false,writable:true,enumerable:true},parallelLimit:{value:1,enumerable:true},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.returnLastJobOnly=true;t.do(e);return t};o.foreach=o.forEach=function w(e,t){var r=Object.create(o.Plan.prototype,s);Object.defineProperties(r,{usingIsIterator:{value:true,writable:true,enumerable:true},errorsAreFatal:{value:false,writable:true,enumerable:true},execInit:{value:a.bind(r)},execNext:{value:l.bind(r)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(r)}});r.do(e);r.iterator(t);return r};o.map=function k(e,t){var r=Object.create(o.Plan.prototype,s);Object.defineProperties(r,{parallelLimit:{value:Infinity,writable:true,enumerable:true},usingIsIterator:{value:true,writable:true,enumerable:true},errorsAreFatal:{value:false,writable:true,enumerable:true},returnMapping1to1:{value:true,writable:false,enumerable:true},execInit:{value:a.bind(r)},execNext:{value:l.bind(r)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(r)}});r.do(e);r.iterator(t);return r};o.reduce=function j(e,t,r){var n=Object.create(o.Plan.prototype,s);Object.defineProperties(n,{parallelLimit:{value:1,writable:false,enumerable:true},usingIsIterator:{value:true,writable:true,enumerable:true},execInit:{value:a.bind(n)},execNext:{value:l.bind(n)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(n)}});if(arguments.length<3){r=t;t=undefined;n.execMappingMinInputs=0;n.execMappingMaxInputs=100;n.execMappingCallbacks=["finally"];n.execMappingAggregateArg=true;n.execMappingMinArgs=1;n.execMappingMaxArgs=102;n.execMappingSignature="( aggregateArg, [finallyCallback] )"}n.transmitAggregate=true;n.returnAggregate=true;n.defaultAggregate=t;n.do(e);n.iterator(r);return n};o.while=function A(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{waterfallMode:{value:false,enumerable:true},whileAction:{value:undefined,writable:true,enumerable:true},whileActionBefore:{value:true,writable:false,enumerable:true},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(t)}});t.while(e);return t};o.and=function _(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{elseAction:{value:undefined,writable:true,enumerable:true},castToBoolean:{value:false,writable:true,enumerable:true},useLogicAnd:{value:true},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});t.do(e);return t};o.or=function C(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{elseAction:{value:undefined,writable:true,enumerable:true},castToBoolean:{value:false,writable:true,enumerable:true},useLogicAnd:{value:false},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});t.do(e);return t};o.if=function T(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{elseAction:{value:true,writable:true,enumerable:true},castToBoolean:{value:true,writable:true,enumerable:true},useLogicAnd:{value:true},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});if(e){t.do(e)}return t};o.if.and=o.if;o.if.or=function M(e){var t=Object.create(o.Plan.prototype,s);Object.defineProperties(t,{elseAction:{value:true,writable:true,enumerable:true},castToBoolean:{value:true,writable:true,enumerable:true},useLogicAnd:{value:false},execInit:{value:a.bind(t)},execNext:{value:l.bind(t)},execCallback:{value:p},execLoopCallback:{value:c},execFinal:{value:h.bind(t)}});if(e){t.do(e)}return t};o.callTimeout=function O(e,t,r,n){if(typeof r!=="function"){throw new Error("[async] async.callTimeout(): argument #0 should be a function")}var i=Object.create(o.Plan.prototype,s);Object.defineProperties(i,{returnLastJobOnly:{value:true,enumerable:true},jobsTimeout:{value:e,writable:true,enumerable:true},execInit:{value:a.bind(i)},execNext:{value:l.bind(i)},execCallback:{value:u},execLoopCallback:{value:c},execFinal:{value:f.bind(i)}});var p=[r.bind(n)].concat(Array.prototype.slice.call(arguments,4));i.do([p]);return i.exec(t)};o.Plan.prototype.do=function E(e){if(this.locked){return this}if(e&&typeof e==="object"){this.jobsData=e}else if(typeof e==="function"){this.jobsData=[e];this.returnLastJobOnly=true}else{this.jobsData={}}this.jobsKeys=Object.keys(this.jobsData);return this};o.Plan.prototype.parallel=function I(e){if(this.locked){return this}if(e===undefined||e===true){this.parallelLimit=Infinity}else if(e===false){this.parallelLimit=1}else if(typeof e==="number"){this.parallelLimit=e}return this};o.Plan.prototype.race=function L(e){if(!this.locked){this.raceMode=e||e===undefined?true:false}return this};o.Plan.prototype.waterfall=function S(e){if(!this.locked){this.waterfallMode=e||e===undefined?true:false}return this};o.Plan.prototype.while=function P(e,t){if(this.locked){return this}this.whileAction=e;if(t!==undefined){this.whileActionBefore=t?true:false}return this};o.Plan.prototype.repeat=function D(e){if(this.locked){return this}var t=0;if(typeof e!=="number"){e=parseInt(e)}this.whileActionBefore=true;this.whileAction=function(r,n,i){t++;i(t<=e)};return this};o.Plan.prototype.fatal=function N(e){if(!this.locked){this.errorsAreFatal=e||e===undefined?true:false}return this};o.Plan.prototype.boolean=function U(e){if(!this.locked){this.castToBoolean=e||e===undefined?true:false}return this};o.Plan.prototype.transmitError=function F(e){if(!this.locked){this.waterfallTransmitError=e||e===undefined?true:false}return this};o.Plan.prototype.timeout=function R(e){if(!this.locked){if(typeof e==="number"){this.jobsTimeout=e}else{this.jobsTimeout=undefined}}return this};o.Plan.prototype.retry=function B(e,t,r,n){if(this.locked){return this}if(typeof e==="number"){this.maxRetry=e}if(typeof t==="number"){this.retryTimeout=t}if(typeof r==="number"){this.retryMultiply=r}if(typeof n==="number"){this.retryMaxTimeout=n}return this};o.Plan.prototype.lastJobOnly=function z(e){if(!this.locked){this.returnLastJobOnly=e||e===undefined?true:false}return this};o.Plan.prototype.mapping1to1=function K(e){if(!this.locked){this.returnMapping1to1=e||e===undefined?true:false}return this};o.Plan.prototype.using=function J(e){if(!this.locked){this.jobsUsing=e}return this};o.Plan.prototype.iterator=function G(e){if(this.locked){return this}this.jobsUsing=e;this.usingIsIterator=true;return this};o.Plan.prototype.aggregator=function H(e,t,r){if(!this.locked){return this}this.transmitAggregate=e||e===undefined?true:false;this.returnAggregate=t||t===undefined?true:false;if(arguments.length>2){this.defaultAggregate=r}return this};o.Plan.prototype.usingIterator=function Y(e){if(!this.locked){this.usingIsIterator=e||e===undefined?true:false}return this};o.Plan.prototype.nice=function W(e){if(this.locked){return this}if(e===undefined||e===null||e===true){this.asyncEventNice=-1}else if(e===false){this.asyncEventNice=-20}else{this.asyncEventNice=e}return this};o.Plan.prototype.then=function Z(e){if(!this.locked){this.thenAction=e}return this};o.Plan.prototype.else=function V(e){if(!this.locked){this.elseAction=e||true}return this};o.Plan.prototype.catch=function q(e){if(!this.locked){this.catchAction=e||true}return this};o.Plan.prototype.finally=function X(e){if(!this.locked){this.finallyAction=e||true}return this};o.Plan.prototype.clone=function $(){var e=Object.create(o.Plan.prototype,s);i(null,e,this);e.locked=false;return e};o.Plan.prototype.export=function Q(e){switch(e){case"execFinally":return this.clone().execFinally.bind(this);case"execThenCatch":return this.clone().execThenCatch.bind(this);case"execThenElse":return this.clone().execThenElse.bind(this);case"execThenElseCatch":return this.clone().execThenElseCatch.bind(this);case"execArgs":return this.clone().execArgs.bind(this);case"execKV":return this.clone().execKV.bind(this);default:return this.clone().exec.bind(this)}};o.Plan.prototype.exec=function ee(){var e={inputs:[],callbacks:{}},t=0,r;if(arguments.length<this.execMappingMinArgs){throw new Error("[async] Too few arguments, in this instance, the function signature is: fn"+this.execMappingSignature)}else if(arguments.length>this.execMappingMaxArgs){throw new Error("[async] Too much arguments, in this instance, the function signature is: fn"+this.execMappingSignature)}if(this.execMappingAggregateArg){t++;e.aggregate=arguments[0]}if(this.execMappingMinInputs===this.execMappingMaxInputs){e.inputs=Array.prototype.slice.call(arguments,t,this.execMappingMaxInputs+t);for(r=0;r<this.execMappingCallbacks.length&&e.inputs.length+r<arguments.length;r++){e.callbacks[this.execMappingCallbacks[r]]=arguments[e.inputs.length+t+r]}}else{e.inputs=Array.prototype.slice.call(arguments,t,-this.execMappingCallbacks.length);for(r=0;r<this.execMappingCallbacks.length;r++){e.callbacks[this.execMappingCallbacks[r]]=arguments[e.inputs.length+t+r]}}return this.execInit(e)};o.Plan.prototype.execFinally=function te(e){return this.execInit({inputs:[],callbacks:{"finally":e}})};o.Plan.prototype.execThenCatch=function re(e,t,r){return this.execInit({inputs:[],callbacks:{then:e,"catch":t,"finally":r}})};o.Plan.prototype.execThenElse=function ne(e,t,r){return this.execInit({inputs:[],callbacks:{then:e,"else":t,"finally":r}})};o.Plan.prototype.execThenElseCatch=function ie(e,t,r,n){return this.execInit({inputs:[],callbacks:{then:e,"else":t,"catch":r,"finally":n}})};o.Plan.prototype.execArgs=function oe(){return this.execInit({inputs:arguments,callbacks:{}})};o.Plan.prototype.execMapping=function se(e){if(this.locked){return this}e=i(null,{minInputs:0,maxInputs:0},e);var t,r,n=5;e.minInputs=parseInt(e.minInputs);e.maxInputs=parseInt(e.maxInputs);if(e.minInputs<e.maxInputs){this.execMappingMinInputs=e.minInputs;this.execMappingMaxInputs=e.maxInputs}else{this.execMappingMinInputs=e.maxInputs;this.execMappingMaxInputs=e.minInputs}this.execMappingCallbacks=Array.isArray(e.callbacks)?e.callbacks:[];this.execMappingInputsName=Array.isArray(e.inputsName)?e.inputsName:[];this.execMappingSignature="( ";if(this.execMappingMinInputs===this.execMappingMaxInputs){this.execMappingMinArgs=this.execMappingMinInputs;this.execMappingMaxArgs=this.execMappingMaxInputs+this.execMappingCallbacks.length;if(e.aggregateArg){this.execMappingAggregateArg=e.aggregateArg;this.execMappingMinArgs++;this.execMappingMaxArgs++;this.execMappingSignature+="aggregateValue"}for(t=0;t<this.execMappingMaxInputs;t++){if(t>0||e.aggregateArg){this.execMappingSignature+=", "}if(t>=n&&typeof this.execMappingInputsName[t]!=="string"){this.execMappingSignature+="... ";break}this.execMappingSignature+=typeof this.execMappingInputsName[t]==="string"?this.execMappingInputsName[t]:"arg#"+(t+1)}for(r=0;r<this.execMappingCallbacks.length;r++){if(t+r>0||e.aggregateArg){this.execMappingSignature+=", "}this.execMappingSignature+="["+this.execMappingCallbacks[r]+"Callback]"}}else{this.execMappingMinArgs=this.execMappingMinInputs+this.execMappingCallbacks.length;this.execMappingMaxArgs=this.execMappingMaxInputs+this.execMappingCallbacks.length;if(e.aggregateArg){this.execMappingAggregateArg=e.aggregateArg;this.execMappingMinArgs++;this.execMappingMaxArgs++;this.execMappingSignature+="aggregateValue"}for(t=0;t<this.execMappingMaxInputs;t++){if(t>0||e.aggregateArg){this.execMappingSignature+=", "}if(t<this.execMappingMinInputs){if(t>=n&&typeof this.execMappingInputsName[t]!=="string"){this.execMappingSignature+="... ";break}this.execMappingSignature+=typeof this.execMappingInputsName[t]==="string"?this.execMappingInputsName[t]:"arg#"+(t+1)}else{if(t>=n&&typeof this.execMappingInputsName[t]!=="string"){this.execMappingSignature+="[...] ";break}this.execMappingSignature+="["+(typeof this.execMappingInputsName[t]==="string"?this.execMappingInputsName[t]:"arg#"+(t+1))+"]"}}for(r=0;r<this.execMappingCallbacks.length;r++){if(t+r>0||e.aggregateArg){this.execMappingSignature+=", "}this.execMappingSignature+=this.execMappingCallbacks[r]+"Callback"}}this.execMappingSignature+=" )";return this};o.Plan.prototype.execKV=function ae(e){if(e.inputs===undefined){e.inputs=[]}else if(!Array.isArray(e.inputs)){e.inputs=[e.inputs]}if(e.callbacks===undefined||typeof e.callbacks!=="object"){e.callbacks={}}if(e.then){e.callbacks.then=e.then}if(e.else){e.callbacks.else=e.else}if(e.catch){e.callbacks.catch=e.catch}if(e.finally){e.callbacks.finally=e.finally}return this.execInit(e)};o.Plan.prototype.execLoop=function le(e){
return this.execInit({},e)};o.Plan.prototype.execJob=function ue(e,t,r,n){var s=this,a,l=e.jobsKeys[r];var u=Object.create(o.JobContext.prototype,{execContext:{value:e,enumerable:true},indexOfKey:{value:r,enumerable:true},tryIndex:{value:n,enumerable:true},aborted:{value:false,writable:true,enumerable:true},abortedLoop:{value:false,writable:true,enumerable:true}});Object.defineProperty(u,"callback",{value:this.execCallback.bind(this,u),enumerable:true});Object.defineProperty(u.callback,"jobContext",{value:u,enumerable:true});e.jobsStatus[l].status="pending";e.jobsStatus[l].tried++;if(typeof this.jobsUsing==="function"){if(this.usingIsIterator){if(this.transmitAggregate){if(this.jobsUsing.length<=3){this.jobsUsing.call(u,e.aggregate,t,u.callback)}else if(this.jobsUsing.length<=4){this.jobsUsing.call(u,e.aggregate,t,Array.isArray(e.jobsData)?r:l,u.callback)}else{this.jobsUsing.call(u,e.aggregate,t,Array.isArray(e.jobsData)?r:l,e.jobsData,u.callback)}}else{if(this.jobsUsing.length<=2){this.jobsUsing.call(u,t,u.callback)}else if(this.jobsUsing.length<=3){this.jobsUsing.call(u,t,Array.isArray(e.jobsData)?r:l,u.callback)}else{this.jobsUsing.call(u,t,Array.isArray(e.jobsData)?r:l,e.jobsData,u.callback)}}}else if(Array.isArray(t)){a=t.slice();if(this.transmitAggregate){a.unshift(e.aggregate)}a.push(u.callback);this.jobsUsing.apply(u,a)}else{this.jobsUsing.call(u,t,u.callback)}}else if(typeof t==="function"){if(this.waterfallMode&&r>0){a=e.results[e.jobsKeys[r-1]].slice(this.waterfallTransmitError?0:1);a.push(u.callback);t.apply(u,a)}else if(Array.isArray(this.jobsUsing)||this.execMappingMaxInputs){if(Array.isArray(this.jobsUsing)){a=i(null,[],this.jobsUsing,e.execInputs)}else{a=i(null,[],e.execInputs)}a.push(u.callback);t.apply(u,a)}else{t.call(u,u.callback)}}else if(Array.isArray(t)&&typeof t[0]==="function"){a=t.slice(1);a.push(u.callback);t[0].apply(u,a)}else if(typeof t==="object"&&t instanceof o.Plan){t.exec(u.callback)}else{this.execCallback.call(this,u);return this}if(e.jobsTimeoutTimers[l]!==undefined){clearTimeout(e.jobsTimeoutTimers[l]);e.jobsTimeoutTimers[l]=undefined}if(e.retriesTimers[l]!==undefined){clearTimeout(e.retriesTimers[l]);e.retriesTimers[l]=undefined}if(typeof this.jobsTimeout==="number"&&this.jobsTimeout!==Infinity){e.jobsTimeoutTimers[l]=setTimeout(function(){e.jobsTimeoutTimers[l]=undefined;e.jobsStatus[l].status="timeout";u.emit("timeout");s.execCallback.call(s,u,new o.AsyncError("jobTimeout"))},this.jobsTimeout)}return this};o.Plan.prototype.execAction=function ce(e,t,r){if(typeof t==="function"){t.apply(e,r)}else if(typeof t==="object"&&t instanceof o.Plan){t.exec()}};o.JobContext=function fe(){throw new Error("[async] Cannot create an async JobContext object directly")};o.JobContext.prototype=Object.create(n.prototype);o.JobContext.prototype.constructor=o.JobContext;o.JobContext.prototype.abort=function pe(){this.aborted=true;this.callback.apply(undefined,arguments)};o.JobContext.prototype.abortLoop=function he(){this.aborted=true;this.abortedLoop=true;this.callback.apply(undefined,arguments)};o.ExecContext=function de(){throw new Error("[async] Cannot create an async ExecContext object directly")};o.ExecContext.prototype=Object.create(n.prototype);o.ExecContext.prototype.constructor=o.ExecContext;o.ExecContext.prototype.getJobsStatus=function ge(){var e,t,r=Array.isArray(this.jobsData)?[]:{};for(e=0;e<this.jobsKeys.length;e++){t=this.jobsKeys[e];r[t]=i(null,{job:this.jobsData[t],result:this.results[t]},this.jobsStatus[t])}return r};function a(e,t){var r,n=Array.isArray(this.jobsData);var s=Object.create(o.ExecContext.prototype,{plan:{value:this},aggregate:{value:"aggregate"in e?e.aggregate:this.defaultAggregate,writable:true,enumerable:true},results:{value:n?[]:{},writable:true,enumerable:true},result:{value:undefined,writable:true,enumerable:true},jobsTimeoutTimers:{value:n?[]:{},writable:true},jobsStatus:{value:n?[]:{},writable:true,enumerable:true},retriesTimers:{value:n?[]:{},writable:true},retriesCounter:{value:n?[]:{},writable:true,enumerable:true},tryUserResponseCounter:{value:n?[]:{},writable:true,enumerable:true},tryResponseCounter:{value:n?[]:{},writable:true,enumerable:true},iterator:{value:0,writable:true,enumerable:true},pending:{value:0,writable:true,enumerable:true},resolved:{value:0,writable:true,enumerable:true},ok:{value:0,writable:true,enumerable:true},failed:{value:0,writable:true,enumerable:true},status:{value:undefined,writable:true,enumerable:true},error:{value:undefined,writable:true,enumerable:true},statusTriggerJobsKey:{value:undefined,writable:true,enumerable:true},whileStatus:{value:undefined,writable:true},whileChecked:{value:false,writable:true}});if(!t){Object.defineProperties(s,{root:{value:s,enumerable:true},jobsData:{value:n?this.jobsData.slice(0):i(null,{},this.jobsData),enumerable:true},jobsKeys:{value:this.jobsKeys.slice(0),enumerable:true},execInputs:{value:e.inputs,enumerable:true},execCallbacks:{value:e.callbacks},whileIterator:{value:0,enumerable:true,writable:true}})}else{Object.defineProperties(s,{root:{value:t.root,enumerable:true},jobsData:{value:t.jobsData,enumerable:true},jobsKeys:{value:t.jobsKeys,enumerable:true},execInputs:{value:t.execInputs,enumerable:true},execCallbacks:{value:t.execCallbacks},whileIterator:{value:t.whileIterator+1,enumerable:true,writable:true}})}Object.defineProperties(s,{waiting:{value:s.jobsKeys.length,writable:true,enumerable:true}});for(r=0;r<s.jobsKeys.length;r++){s.jobsStatus[s.jobsKeys[r]]={status:"waiting",errors:[],tried:0}}s.setNice(this.asyncEventNice);if(t===undefined){s.root.on("resolved",this.execFinal.bind(this,s));if(typeof this.whileAction==="function"){s.root.on("while",this.whileAction.bind(this));s.root.on("nextLoop",this.execLoop.bind(this))}else{this.whileAction=undefined;s.whileStatus=false}s.root.on("next",this.execNext.bind(this));if(this.whileAction&&this.whileActionBefore){s.whileIterator=-1;s.root.emit("while",s.error,s.results,this.execLoopCallback.bind(this,s),null);return this}}if(s.jobsKeys.length<=0){s.root.emit("resolved",s.error,s.results);s.root.emit("progress",{resolved:s.resolved,ok:s.ok,failed:s.failed,pending:s.pending,waiting:s.waiting,loop:s.whileIterator},s.error,s.results);s.root.emit("finish",s.error,s.results);return s.root}s.root.emit("next",s);return s.root}function l(e){var t,r,n=e.jobsKeys.length,i,o;i=e.iterator;for(;e.iterator<n&&e.pending<this.parallelLimit;e.iterator++){e.pending++;e.waiting--;t=e.iterator;r=e.jobsKeys[t];e.retriesCounter[r]=0;e.tryResponseCounter[r]=[];e.tryResponseCounter[r][0]=0;e.tryUserResponseCounter[r]=[];e.tryUserResponseCounter[r][0]=0;e.results[r]=undefined;o=e.iterator}for(t=i;t<=o;t++){this.execJob(e,e.jobsData[e.jobsKeys[t]],t,0)}}function u(e,t){var r=e.execContext,n=e.aborted,i=e.abortedLoop,s=e.indexOfKey,a=e.tryIndex;var l=this,u,c,f=r.jobsKeys.length,p=r.jobsKeys[s];var h=false,d=false,g=false,b=false;r.tryResponseCounter[p][a]++;if(!(t instanceof o.AsyncError)){r.tryUserResponseCounter[p][a]++}if(r.jobsTimeoutTimers[p]!==undefined){clearTimeout(r.jobsTimeoutTimers[p]);r.jobsTimeoutTimers[p]=undefined}if(r.retriesTimers[p]!==undefined){clearTimeout(r.retriesTimers[p]);r.retriesTimers[p]=undefined}if(r.tryUserResponseCounter[p][a]>1){r.jobsStatus[p].errors.push(new Error("This job has called its completion callback "+r.tryUserResponseCounter[p][a]+" times"));return}if(!n&&r.results[p]!==undefined){return}if(!n&&t&&this.maxRetry>r.retriesCounter[p]&&r.tryResponseCounter[p][a]<=1){r.jobsStatus[p].errors.push(t);u=this.retryTimeout*Math.pow(this.retryMultiply,r.retriesCounter[p]);if(u>this.retryMaxTimeout){u=this.retryMaxTimeout}r.retriesCounter[p]++;c=r.retriesCounter[p];r.retriesTimers[p]=setTimeout(function(){r.retriesTimers[p]=undefined;r.tryResponseCounter[p][c]=0;r.tryUserResponseCounter[p][c]=0;l.execJob(r,r.jobsData[p],s,c)},u);return}if(!n&&t&&a<r.retriesCounter[p]){return}r.resolved++;r.pending--;r.aggregate=arguments[2];if(n){r.failed++;r.jobsStatus[p].status="aborted"}else if(t){r.failed++;r.jobsStatus[p].errors.push(t);if(t instanceof o.AsyncError&&t.message==="jobTimeout"){r.jobsStatus[p].status="timeout"}else{r.jobsStatus[p].status="failed"}}else{r.ok++;r.jobsStatus[p].status="ok"}if(this.returnMapping1to1){r.results[p]=arguments[2]}else{r.results[p]=Array.prototype.slice.call(arguments,1)}if(r.status===undefined){if(this.raceMode&&!t){r.status="ok";r.statusTriggerJobsKey=p;if(this.whileAction&&!i){b=true}else{d=true}}else if(!this.raceMode&&t&&this.errorsAreFatal){r.status="fail";r.error=t;r.statusTriggerJobsKey=p;if(this.whileAction&&!i){b=true}else{d=true}}else if(n){r.status="aborted";r.statusTriggerJobsKey=p;if(this.whileAction&&!i){b=true}else{d=true}}}if(r.resolved>=f){if(r.status===undefined){if(this.raceMode){r.status="fail"}else{r.status="ok"}r.statusTriggerJobsKey=p;if(this.whileAction){b=true}else{d=g=true}}else{if(!this.whileAction||r.whileChecked&&r.whileStatus!==true){g=true}}}else if(r.status===undefined){if(r.iterator<f){h=true}}else if(r.pending<=0){if(!this.whileAction||r.whileChecked&&r.whileStatus!==true){g=true}}if(d){r.root.emit("resolved",r.error,r.results)}if(h){r.root.emit("next",r)}if(b){r.root.emit("while",r.error,r.results,this.execLoopCallback.bind(this,r),null)}r.root.emit("progress",{resolved:r.resolved,ok:r.ok,failed:r.failed,pending:r.pending,waiting:r.waiting,loop:r.whileIterator},r.error,r.results);if(g){r.root.emit("finish",r.error,r.results)}}function c(e){var t,r;var n=false,i=false,o=false;if(arguments.length<=1){t=undefined;r=false}else if(arguments[1]instanceof Error){e.error=arguments[1];t=arguments[1];r=false}else if(arguments.length<=2){t=arguments[1];r=t?true:false}else{t=arguments[2];r=t?true:false}if(r){e.whileStatus=true;n=true}else{e.whileStatus=false;i=true;if(e.pending<=0){o=true}}if(i){e.root.emit("resolved",e.error,e.results)}if(n){e.root.emit("nextLoop",e)}if(o){e.root.emit("finish",e.error,e.results)}e.whileChecked=true}function f(e,t,r){var n;if(t){if(this.returnAggregate){n=[t,e.aggregate]}else if(this.returnLastJobOnly){n=r[e.statusTriggerJobsKey]}else{n=[t,r]}if(this.catchAction){this.execAction(e,this.catchAction,n)}if(t&&e.execCallbacks.catch){this.execAction(e,e.execCallbacks.catch,n)}}else{if(this.returnAggregate){n=[e.aggregate]}else if(this.returnLastJobOnly){n=r[e.statusTriggerJobsKey].slice(1)}else{n=[r]}if(this.thenAction){this.execAction(e,this.thenAction,n)}if(e.execCallbacks.then){this.execAction(e,e.execCallbacks.then,n)}}if(this.returnAggregate){n=[t,e.aggregate]}else if(this.returnLastJobOnly){n=r[e.statusTriggerJobsKey]}else{n=[t,r]}if(this.finallyAction){this.execAction(e,this.finallyAction,n)}if(e.execCallbacks.finally){this.execAction(e,e.execCallbacks.finally,n)}}function p(e){var t=e.execContext,r=e.indexOfKey,n=e.tryIndex;var i=this,s,a,l,u,c=t.jobsKeys.length,f=t.jobsKeys[r];var p=false,h=false,d=false;if(arguments.length<=1){t.result=undefined;s=false}else if(arguments[1]instanceof Error){t.error=u=arguments[1];t.result=arguments[1];s=false}else if(arguments.length<=2){t.result=arguments[1];s=t.result?true:false}else{t.result=arguments[2];s=t.result?true:false}t.tryResponseCounter[f][n]++;if(!(u instanceof o.AsyncError)){t.tryUserResponseCounter[f][n]++}if(t.jobsTimeoutTimers[f]!==undefined){clearTimeout(t.jobsTimeoutTimers[f]);t.jobsTimeoutTimers[f]=undefined}if(t.retriesTimers[f]!==undefined){clearTimeout(t.retriesTimers[f]);t.retriesTimers[f]=undefined}if(t.results[f]!==undefined){return}if(t.tryUserResponseCounter[f][n]>1){return}if(u&&this.maxRetry>t.retriesCounter[f]&&t.tryResponseCounter[f][n]<=1){a=this.retryTimeout*Math.pow(this.retryMultiply,t.retriesCounter[f]);if(a>this.retryMaxTimeout){a=this.retryMaxTimeout}t.retriesCounter[f]++;l=t.retriesCounter[f];t.retriesTimers[f]=setTimeout(function(){t.retriesTimers[f]=undefined;t.tryResponseCounter[f][l]=0;t.tryUserResponseCounter[f][l]=0;i.execJob(t,t.jobsData[f],r,l)},a);return}if(u&&n<t.retriesCounter[f]){return}t.resolved++;t.pending--;if(u){t.failed++;if(u instanceof o.AsyncError&&u.message==="jobTimeout"){t.jobsStatus[f].status="timeout"}else{t.jobsStatus[f].status="failed"}}else{t.ok++;t.jobsStatus[f].status="ok"}if(this.castToBoolean&&(!(t.result instanceof Error)||!this.catchAction)){t.result=s}t.results[f]=t.result;if(s!==this.useLogicAnd&&t.status===undefined){t.status=!this.useLogicAnd;h=true}if(t.resolved>=c){if(t.status===undefined){t.status=this.useLogicAnd;h=true}d=true}else if(t.status===undefined){if(t.iterator<c){p=true}}else if(t.pending<=0){d=true}if(h){t.root.emit("resolved",t.result)}if(p){t.root.emit("next",t)}t.root.emit("progress",{resolved:t.resolved,pending:t.pending,waiting:t.waiting,loop:t.whileIterator},t.result);if(d){t.root.emit("finish",t.result)}}function h(e,t){if(t instanceof Error){if(this.catchAction){this.execAction(e,this.catchAction,[t])}else if(this.elseAction){this.execAction(e,this.elseAction,[t])}}else if(!e.result&&this.elseAction){this.execAction(e,this.elseAction,[t])}else if(e.result&&this.thenAction){this.execAction(e,this.thenAction,[t])}if(this.finallyAction){this.execAction(e,this.finallyAction,[t])}if(t instanceof Error){if(e.execCallbacks.catch){this.execAction(e,e.execCallbacks.catch,[t])}else if(e.execCallbacks.else){this.execAction(e,e.execCallbacks.else,[t])}}else if(!e.result&&e.execCallbacks.else){this.execAction(e,e.execCallbacks.else,[t])}else if(e.result&&e.execCallbacks.then){this.execAction(e,e.execCallbacks.then,[t])}if(e.execCallbacks.finally){this.execAction(e,e.execCallbacks.finally,[t])}}},{"nextgen-events":9,"tree-kit/lib/extend.js":32}],7:[function(e,t,r){(function(r){"use strict";var n=e("./async.js");var i=false;function o(e,t){if(i){return}i=true;var o=r.listeners("asyncExit");if(!o.length){r.exit(e);return}if(t===undefined){t=1e3}n.parallel(o).using(function(r,n){if(r.length<3){r(e,t);n()}else{r(e,t,n)}}).fatal(false).timeout(t).exec(function(){r.exit(e)})}t.exports=o}).call(this,e("_process"))},{"./async.js":5,_process:14}],8:[function(e,t,r){"use strict";var n={};t.exports=n;n.timeout=function i(e,t,r){var n=function(){var n=r||this,i=false,o=Array.prototype.slice.call(arguments),s=o.pop();var a=function(){if(i){return}i=true;s.apply(n,arguments)};o.push(a);e.apply(n,o);setTimeout(a.bind(undefined,new Error("Timeout")),t)};return n}},{}],9:[function(e,t,r){"use strict";function n(){return Object.create(n.prototype)}t.exports=n;n.SYNC=-Infinity;n.init=function o(){Object.defineProperty(this,"__ngev",{value:{nice:n.SYNC,interruptible:false,recursion:0,contexts:{},events:{error:[],interrupt:[],newListener:[],removeListener:[]}}})};n.filterOutCallback=function(e,t){return e!==t};n.prototype.addListener=function s(e,t,r){var i={};if(!this.__ngev){n.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}if(!e||typeof e!=="string"){throw new TypeError(".addListener(): argument #0 should be a non-empty string")}if(typeof t!=="function"){r=t;t=undefined}if(!r||typeof r!=="object"){r={}}i.fn=t||r.fn;i.id=typeof r.id==="string"?r.id:i.fn;i.once=!!r.once;i.async=!!r.async;i.nice=r.nice!==undefined?Math.floor(r.nice):n.SYNC;i.context=typeof r.context==="string"?r.context:null;if(typeof i.fn!=="function"){throw new TypeError(".addListener(): a function or an object with a 'fn' property which value is a function should be provided")}if(i.context&&typeof i.context==="string"&&!this.__ngev.contexts[i.context]){this.addListenerContext(i.context)}i.event=e;if(this.__ngev.events.newListener.length){this.emit("newListener",[i])}this.__ngev.events[e].push(i);return this};n.prototype.on=n.prototype.addListener;n.prototype.once=function a(e,t){if(!e||typeof e!=="string"){throw new TypeError(".once(): argument #0 should be a non-empty string")}if(typeof t==="function"){t={id:t,fn:t}}else if(!t||typeof t!=="object"||typeof t.fn!=="function"){throw new TypeError(".once(): argument #1 should be a function or an object with a 'fn' property which value is a function")}t.once=true;return this.addListener(e,t)};n.prototype.removeListener=function l(e,t){var r,i,o=[],s=[];if(!e||typeof e!=="string"){throw new TypeError(".removeListener(): argument #0 should be a non-empty string")}if(!this.__ngev){n.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}i=this.__ngev.events[e].length;for(r=0;r<i;r++){if(this.__ngev.events[e][r].id===t){s.push(this.__ngev.events[e][r])}else{o.push(this.__ngev.events[e][r])}}this.__ngev.events[e]=o;if(s.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",s)}return this};n.prototype.off=n.prototype.removeListener;n.prototype.removeAllListeners=function u(e){var t;if(!this.__ngev){n.init.call(this)}if(e){if(!e||typeof e!=="string"){throw new TypeError(".removeAllListener(): argument #0 should be undefined or a non-empty string")}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}t=this.__ngev.events[e];this.__ngev.events[e]=[];if(t.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",t)}}else{this.__ngev.events={}}return this};n.listenerWrapper=function c(e,t,r){var i,o;if(t.interrupt){return}if(e.async){if(r){o=r.serial;r.ready=!o}i=e.fn.apply(undefined,t.args.concat(function(r){t.listenersDone++;if(r&&t.emitter.__ngev.interruptible&&!t.interrupt&&t.name!=="interrupt"){t.interrupt=r;if(t.callback){t.callback(t.interrupt,t);delete t.callback}t.emitter.emit("interrupt",t.interrupt)}else if(t.listenersDone>=t.listeners&&t.callback){t.callback(undefined,t);delete t.callback}if(o){n.processQueue.call(t.emitter,e.context,true)}}))}else{i=e.fn.apply(undefined,t.args);t.listenersDone++}if(i&&t.emitter.__ngev.interruptible&&!t.interrupt&&t.name!=="interrupt"){t.interrupt=i;if(t.callback){t.callback(t.interrupt,t);delete t.callback}t.emitter.emit("interrupt",t.interrupt)}else if(t.listenersDone>=t.listeners&&t.callback){t.callback(undefined,t);delete t.callback}};var i=0;n.prototype.emit=function f(){var e,t,r=0,o,s,a,l,u,c=[];o={emitter:this,id:i++,name:null,args:null,nice:null,interrupt:null,listeners:null,listenersDone:0,callback:null};if(!this.__ngev){n.init.call(this)}if(typeof arguments[0]==="number"){o.nice=Math.floor(arguments[0]);o.name=arguments[1];if(!o.name||typeof o.name!=="string"){throw new TypeError(".emit(): when argument #0 is a number, argument #1 should be a non-empty string")}if(typeof arguments[arguments.length-1]==="function"){o.callback=arguments[arguments.length-1];o.args=Array.prototype.slice.call(arguments,2,-1)}else{o.args=Array.prototype.slice.call(arguments,2)}}else{o.nice=this.__ngev.nice;o.name=arguments[0];if(!o.name||typeof o.name!=="string"){throw new TypeError(".emit(): argument #0 should be an number or a non-empty string")}o.args=Array.prototype.slice.call(arguments,1);if(typeof arguments[arguments.length-1]==="function"){o.callback=arguments[arguments.length-1];o.args=Array.prototype.slice.call(arguments,1,-1)}else{o.args=Array.prototype.slice.call(arguments,1)}}if(!this.__ngev.events[o.name]){this.__ngev.events[o.name]=[]}o.listeners=this.__ngev.events[o.name].length;this.__ngev.recursion++;u=this.__ngev.events[o.name].slice();for(e=0,t=u.length;e<t;e++){r++;s=u[e];a=s.context&&this.__ngev.contexts[s.context];if(a&&a.status===n.CONTEXT_DISABLED){continue}if(a){l=Math.max(o.nice,s.nice,a.nice)}else{l=Math.max(o.nice,s.nice)}if(s.once){this.__ngev.events[o.name]=this.__ngev.events[o.name].filter(n.filterOutCallback.bind(undefined,s));c.push(s)}if(a&&(a.status===n.CONTEXT_QUEUED||!a.ready)){a.queue.push({event:o,listener:s,nice:l})}else{try{if(l<0){if(this.__ngev.recursion>=-l){setImmediate(n.listenerWrapper.bind(this,s,o,a))}else{n.listenerWrapper.call(this,s,o,a)}}else{setTimeout(n.listenerWrapper.bind(this,s,o,a),l)}}catch(f){this.__ngev.recursion--;throw f}}}this.__ngev.recursion--;if(c.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",c)}if(!r){if(o.name==="error"){if(arguments[1]){throw arguments[1]}else{throw Error("Uncaught, unspecified 'error' event.")}}if(o.callback){o.callback(undefined,o);delete o.callback}}return o};n.prototype.listeners=function p(e){if(!e||typeof e!=="string"){throw new TypeError(".listeners(): argument #0 should be a non-empty string")}if(!this.__ngev){n.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}return this.__ngev.events[e].slice()};n.listenerCount=function(e,t){if(!e||!(e instanceof n)){throw new TypeError(".listenerCount(): argument #0 should be an instance of NextGenEvents")}return e.listenerCount(t)};n.prototype.listenerCount=function(e){if(!e||typeof e!=="string"){throw new TypeError(".listenerCount(): argument #1 should be a non-empty string")}if(!this.__ngev){n.init.call(this)}if(!this.__ngev.events[e]){this.__ngev.events[e]=[]}return this.__ngev.events[e].length};n.prototype.setNice=function h(e){if(!this.__ngev){n.init.call(this)}this.__ngev.nice=Math.floor(+e||0)};n.prototype.setInterruptible=function d(e){if(!this.__ngev){n.init.call(this)}this.__ngev.interruptible=!!e};n.prototype.setMaxListeners=function(){};n.noop=function(){};n.CONTEXT_ENABLED=0;n.CONTEXT_DISABLED=1;n.CONTEXT_QUEUED=2;n.prototype.addListenerContext=function g(e,t){if(!this.__ngev){n.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".addListenerContext(): argument #0 should be a non-empty string")}if(!t||typeof t!=="object"){t={}}if(!this.__ngev.contexts[e]){this.__ngev.contexts[e]=Object.create(n.prototype);this.__ngev.contexts[e].nice=n.SYNC;this.__ngev.contexts[e].ready=true;this.__ngev.contexts[e].status=n.CONTEXT_ENABLED;this.__ngev.contexts[e].serial=false;this.__ngev.contexts[e].queue=[]}if(t.nice!==undefined){this.__ngev.contexts[e].nice=Math.floor(t.nice)}if(t.status!==undefined){this.__ngev.contexts[e].status=t.status}if(t.serial!==undefined){this.__ngev.contexts[e].serial=!!t.serial}return this};n.prototype.disableListenerContext=function b(e){if(!this.__ngev){n.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".disableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=n.CONTEXT_DISABLED;return this};n.prototype.enableListenerContext=function y(e){if(!this.__ngev){n.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".enableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=n.CONTEXT_ENABLED;if(this.__ngev.contexts[e].queue.length>0){n.processQueue.call(this,e)}return this};n.prototype.queueListenerContext=function m(e){if(!this.__ngev){n.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".queueListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].status=n.CONTEXT_QUEUED;return this};n.prototype.serializeListenerContext=function v(e,t){if(!this.__ngev){n.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".serializeListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].serial=t===undefined?true:!!t;return this};n.prototype.setListenerContextNice=function x(e,t){if(!this.__ngev){n.init.call(this)}if(!e||typeof e!=="string"){throw new TypeError(".setListenerContextNice(): argument #0 should be a non-empty string")}if(!this.__ngev.contexts[e]){this.addListenerContext(e)}this.__ngev.contexts[e].nice=Math.floor(t);return this};n.prototype.destroyListenerContext=function w(e){var t,r,i,o,s=[];if(!e||typeof e!=="string"){throw new TypeError(".disableListenerContext(): argument #0 should be a non-empty string")}if(!this.__ngev){n.init.call(this)}for(i in this.__ngev.events){o=null;r=this.__ngev.events[i].length;for(t=0;t<r;t++){if(this.__ngev.events[i][t].context===e){o=[];s.push(this.__ngev.events[i][t])}else if(o){o.push(this.__ngev.events[i][t])}}if(o){this.__ngev.events[i]=o}}if(this.__ngev.contexts[e]){delete this.__ngev.contexts[e]}if(s.length&&this.__ngev.events.removeListener.length){this.emit("removeListener",s)}return this};n.processQueue=function k(e,t){var r,i;if(!this.__ngev.contexts[e]){return}r=this.__ngev.contexts[e];if(t){r.ready=true}this.__ngev.recursion++;while(r.ready&&r.queue.length){i=r.queue.shift();if(i.event.interrupt){continue}try{if(i.nice<0){if(this.__ngev.recursion>=-i.nice){setImmediate(n.listenerWrapper.bind(this,i.listener,i.event,r))}else{n.listenerWrapper.call(this,i.listener,i.event,r)}}else{setTimeout(n.listenerWrapper.bind(this,i.listener,i.event,r),i.nice)}}catch(o){this.__ngev.recursion--;throw o}}this.__ngev.recursion--}},{}],10:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function n(e,t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}}},{}],11:[function(e,t,r){t.exports=function(e){return!!(e!=null&&(e._isBuffer||e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)))}},{}],12:[function(e,t,r){r.endianness=function(){return"LE"};r.hostname=function(){if(typeof location!=="undefined"){return location.hostname}else return""};r.loadavg=function(){return[]};r.uptime=function(){return 0};r.freemem=function(){return Number.MAX_VALUE};r.totalmem=function(){return Number.MAX_VALUE};r.cpus=function(){return[]};r.type=function(){return"Browser"};r.release=function(){if(typeof navigator!=="undefined"){return navigator.appVersion}return""};r.networkInterfaces=r.getNetworkInterfaces=function(){return{}};r.arch=function(){return"javascript"};r.platform=function(){return"browser"};r.tmpdir=r.tmpDir=function(){return"/tmp"};r.EOL="\n"},{}],13:[function(e,t,r){(function(e){function t(e,t){var r=0;for(var n=e.length-1;n>=0;n--){var i=e[n];if(i==="."){e.splice(n,1)}else if(i===".."){e.splice(n,1);r++}else if(r){e.splice(n,1);r--}}if(t){for(;r--;r){e.unshift("..")}}return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var i=function(e){return n.exec(e).slice(1)};r.resolve=function(){var r="",n=false;for(var i=arguments.length-1;i>=-1&&!n;i--){var s=i>=0?arguments[i]:e.cwd();if(typeof s!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!s){continue}r=s+"/"+r;n=s.charAt(0)==="/"}r=t(o(r.split("/"),function(e){return!!e}),!n).join("/");return(n?"/":"")+r||"."};r.normalize=function(e){var n=r.isAbsolute(e),i=s(e,-1)==="/";e=t(o(e.split("/"),function(e){return!!e}),!n).join("/");if(!e&&!n){e="."}if(e&&i){e+="/"}return(n?"/":"")+e};r.isAbsolute=function(e){return e.charAt(0)==="/"};r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(o(e,function(e,t){if(typeof e!=="string"){throw new TypeError("Arguments to path.join must be strings")}return e}).join("/"))};r.relative=function(e,t){e=r.resolve(e).substr(1);t=r.resolve(t).substr(1);function n(e){var t=0;for(;t<e.length;t++){if(e[t]!=="")break}var r=e.length-1;for(;r>=0;r--){if(e[r]!=="")break}if(t>r)return[];return e.slice(t,r-t+1)}var i=n(e.split("/"));var o=n(t.split("/"));var s=Math.min(i.length,o.length);var a=s;for(var l=0;l<s;l++){if(i[l]!==o[l]){a=l;break}}var u=[];for(var l=a;l<i.length;l++){u.push("..")}u=u.concat(o.slice(a));return u.join("/")};r.sep="/";r.delimiter=":";r.dirname=function(e){var t=i(e),r=t[0],n=t[1];if(!r&&!n){return"."}if(n){n=n.substr(0,n.length-1)}return r+n};r.basename=function(e,t){var r=i(e)[2];if(t&&r.substr(-1*t.length)===t){r=r.substr(0,r.length-t.length)}return r};r.extname=function(e){return i(e)[3]};function o(e,t){if(e.filter)return e.filter(t);var r=[];for(var n=0;n<e.length;n++){if(t(e[n],n,e))r.push(e[n])}return r}var s="ab".substr(-1)==="b"?function(e,t,r){return e.substr(t,r)}:function(e,t,r){if(t<0)t=e.length+t;return e.substr(t,r)}}).call(this,e("_process"))},{_process:14}],14:[function(e,t,r){var n=t.exports={};var i;var o;(function(){try{i=setTimeout}catch(e){i=function(){throw new Error("setTimeout is not defined")}}try{o=clearTimeout}catch(e){o=function(){throw new Error("clearTimeout is not defined")}}})();var s=[];var a=false;var l;var u=-1;function c(){if(!a||!l){return}a=false;if(l.length){s=l.concat(s)}else{u=-1}if(s.length){f()}}function f(){if(a){return}var e=i(c);a=true;var t=s.length;while(t){l=s;s=[];while(++u<t){if(l){l[u].run()}}u=-1;t=s.length}l=null;a=false;o(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}s.push(new p(e,t));if(s.length===1&&!a){i(f,0)}};function p(e,t){this.fun=e;this.array=t}p.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function h(){}n.on=h;n.addListener=h;n.once=h;n.off=h;n.removeListener=h;n.removeAllListeners=h;n.emit=h;n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],15:[function(t,r,n){(function(t){(function(i){var o=typeof n=="object"&&n&&!n.nodeType&&n;var s=typeof r=="object"&&r&&!r.nodeType&&r;var a=typeof t=="object"&&t;if(a.global===a||a.window===a||a.self===a){i=a}var l,u=2147483647,c=36,f=1,p=26,h=38,d=700,g=72,b=128,y="-",m=/^xn--/,v=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=c-f,j=Math.floor,A=String.fromCharCode,_;function C(e){throw new RangeError(w[e])}function T(e,t){var r=e.length;var n=[];while(r--){n[r]=t(e[r])}return n}function M(e,t){var r=e.split("@");var n="";if(r.length>1){n=r[0]+"@";e=r[1]}e=e.replace(x,".");var i=e.split(".");var o=T(i,t).join(".");return n+o}function O(e){var t=[],r=0,n=e.length,i,o;while(r<n){i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){o=e.charCodeAt(r++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);r--}}else{t.push(i)}}return t}function E(e){return T(e,function(e){var t="";if(e>65535){e-=65536;t+=A(e>>>10&1023|55296);e=56320|e&1023}t+=A(e);return t}).join("")}function I(e){if(e-48<10){return e-22}if(e-65<26){return e-65}if(e-97<26){return e-97}return c}function L(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function S(e,t,r){var n=0;e=r?j(e/d):e>>1;e+=j(e/t);for(;e>k*p>>1;n+=c){e=j(e/k)}return j(n+(k+1)*e/(e+h))}function P(e){var t=[],r=e.length,n,i=0,o=b,s=g,a,l,h,d,m,v,x,w,k;a=e.lastIndexOf(y);if(a<0){a=0}for(l=0;l<a;++l){if(e.charCodeAt(l)>=128){C("not-basic")}t.push(e.charCodeAt(l))}for(h=a>0?a+1:0;h<r;){for(d=i,m=1,v=c;;v+=c){if(h>=r){C("invalid-input")}x=I(e.charCodeAt(h++));if(x>=c||x>j((u-i)/m)){C("overflow")}i+=x*m;w=v<=s?f:v>=s+p?p:v-s;if(x<w){break}k=c-w;if(m>j(u/k)){C("overflow")}m*=k}n=t.length+1;s=S(i-d,n,d==0);if(j(i/n)>u-o){C("overflow")}o+=j(i/n);i%=n;t.splice(i++,0,o)}return E(t)}function D(e){var t,r,n,i,o,s,a,l,h,d,m,v=[],x,w,k,_;e=O(e);x=e.length;t=b;r=0;o=g;for(s=0;s<x;++s){m=e[s];if(m<128){v.push(A(m))}}n=i=v.length;if(i){v.push(y)}while(n<x){for(a=u,s=0;s<x;++s){m=e[s];if(m>=t&&m<a){a=m}}w=n+1;if(a-t>j((u-r)/w)){C("overflow")}r+=(a-t)*w;t=a;for(s=0;s<x;++s){m=e[s];if(m<t&&++r>u){C("overflow")}if(m==t){for(l=r,h=c;;h+=c){d=h<=o?f:h>=o+p?p:h-o;if(l<d){break}_=l-d;k=c-d;v.push(A(L(d+_%k,0)));l=j(_/k)}v.push(A(L(l,0)));o=S(r,w,n==i);r=0;++n}}++r;++t}return v.join("")}function N(e){return M(e,function(e){return m.test(e)?P(e.slice(4).toLowerCase()):e})}function U(e){return M(e,function(e){return v.test(e)?"xn--"+D(e):e})}l={version:"1.4.1",ucs2:{decode:O,encode:E},decode:P,encode:D,toASCII:U,toUnicode:N};if(typeof e=="function"&&typeof e.amd=="object"&&e.amd){e("punycode",function(){return l})}else if(o&&s){if(r.exports==o){s.exports=l}else{for(_ in l){l.hasOwnProperty(_)&&(o[_]=l[_])}}}else{i.punycode=l;
}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],16:[function(e,t,r){t.exports=function n(e){return e&&typeof e==="object"&&typeof e.copy==="function"&&typeof e.fill==="function"&&typeof e.readUInt8==="function"}},{}],17:[function(e,t,r){(function(t,n){var i=/%[sdj%]/g;r.format=function(e){if(!k(e)){var t=[];for(var r=0;r<arguments.length;r++){t.push(a(arguments[r]))}return t.join(" ")}var r=1;var n=arguments;var o=n.length;var s=String(e).replace(i,function(e){if(e==="%%")return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return e}});for(var l=n[r];r<o;l=n[++r]){if(v(l)||!C(l)){s+=" "+l}else{s+=" "+a(l)}}return s};r.deprecate=function(e,i){if(A(n.process)){return function(){return r.deprecate(e,i).apply(this,arguments)}}if(t.noDeprecation===true){return e}var o=false;function s(){if(!o){if(t.throwDeprecation){throw new Error(i)}else if(t.traceDeprecation){console.trace(i)}else{console.error(i)}o=true}return e.apply(this,arguments)}return s};var o={};var s;r.debuglog=function(e){if(A(s))s=t.env.NODE_DEBUG||"";e=e.toUpperCase();if(!o[e]){if(new RegExp("\\b"+e+"\\b","i").test(s)){var n=t.pid;o[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else{o[e]=function(){}}}return o[e]};function a(e,t){var n={seen:[],stylize:u};if(arguments.length>=3)n.depth=arguments[2];if(arguments.length>=4)n.colors=arguments[3];if(m(t)){n.showHidden=t}else if(t){r._extend(n,t)}if(A(n.showHidden))n.showHidden=false;if(A(n.depth))n.depth=2;if(A(n.colors))n.colors=false;if(A(n.customInspect))n.customInspect=true;if(n.colors)n.stylize=l;return f(n,e,n.depth)}r.inspect=a;a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};a.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function l(e,t){var r=a.styles[t];if(r){return"["+a.colors[r][0]+"m"+e+"["+a.colors[r][1]+"m"}else{return e}}function u(e,t){return e}function c(e){var t={};e.forEach(function(e,r){t[e]=true});return t}function f(e,t,n){if(e.customInspect&&t&&O(t.inspect)&&t.inspect!==r.inspect&&!(t.constructor&&t.constructor.prototype===t)){var i=t.inspect(n,e);if(!k(i)){i=f(e,i,n)}return i}var o=p(e,t);if(o){return o}var s=Object.keys(t);var a=c(s);if(e.showHidden){s=Object.getOwnPropertyNames(t)}if(M(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0)){return h(t)}if(s.length===0){if(O(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(_(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}if(T(t)){return e.stylize(Date.prototype.toString.call(t),"date")}if(M(t)){return h(t)}}var u="",m=false,v=["{","}"];if(y(t)){m=true;v=["[","]"]}if(O(t)){var x=t.name?": "+t.name:"";u=" [Function"+x+"]"}if(_(t)){u=" "+RegExp.prototype.toString.call(t)}if(T(t)){u=" "+Date.prototype.toUTCString.call(t)}if(M(t)){u=" "+h(t)}if(s.length===0&&(!m||t.length==0)){return v[0]+u+v[1]}if(n<0){if(_(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(t);var w;if(m){w=d(e,t,n,a,s)}else{w=s.map(function(r){return g(e,t,n,a,r,m)})}e.seen.pop();return b(w,u,v)}function p(e,t){if(A(t))return e.stylize("undefined","undefined");if(k(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(w(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,i){var o=[];for(var s=0,a=t.length;s<a;++s){if(D(t,String(s))){o.push(g(e,t,r,n,String(s),true))}else{o.push("")}}i.forEach(function(i){if(!i.match(/^\d+$/)){o.push(g(e,t,r,n,i,true))}});return o}function g(e,t,r,n,i,o){var s,a,l;l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]};if(l.get){if(l.set){a=e.stylize("[Getter/Setter]","special")}else{a=e.stylize("[Getter]","special")}}else{if(l.set){a=e.stylize("[Setter]","special")}}if(!D(n,i)){s="["+i+"]"}if(!a){if(e.seen.indexOf(l.value)<0){if(v(r)){a=f(e,l.value,null)}else{a=f(e,l.value,r-1)}if(a.indexOf("\n")>-1){if(o){a=a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{a="\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{a=e.stylize("[Circular]","special")}}if(A(s)){if(o&&i.match(/^\d+$/)){return a}s=JSON.stringify(""+i);if(s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){s=s.substr(1,s.length-2);s=e.stylize(s,"name")}else{s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");s=e.stylize(s,"string")}}return s+": "+a}function b(e,t,r){var n=0;var i=e.reduce(function(e,t){n++;if(t.indexOf("\n")>=0)n++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(i>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]}function y(e){return Array.isArray(e)}r.isArray=y;function m(e){return typeof e==="boolean"}r.isBoolean=m;function v(e){return e===null}r.isNull=v;function x(e){return e==null}r.isNullOrUndefined=x;function w(e){return typeof e==="number"}r.isNumber=w;function k(e){return typeof e==="string"}r.isString=k;function j(e){return typeof e==="symbol"}r.isSymbol=j;function A(e){return e===void 0}r.isUndefined=A;function _(e){return C(e)&&I(e)==="[object RegExp]"}r.isRegExp=_;function C(e){return typeof e==="object"&&e!==null}r.isObject=C;function T(e){return C(e)&&I(e)==="[object Date]"}r.isDate=T;function M(e){return C(e)&&(I(e)==="[object Error]"||e instanceof Error)}r.isError=M;function O(e){return typeof e==="function"}r.isFunction=O;function E(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}r.isPrimitive=E;r.isBuffer=e("./support/isBuffer");function I(e){return Object.prototype.toString.call(e)}function L(e){return e<10?"0"+e.toString(10):e.toString(10)}var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var e=new Date;var t=[L(e.getHours()),L(e.getMinutes()),L(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}r.log=function(){console.log("%s - %s",P(),r.format.apply(r,arguments))};r.inherits=e("inherits");r._extend=function(e,t){if(!t||!C(t))return e;var r=Object.keys(t);var n=r.length;while(n--){e[r[n]]=t[r[n]]}return e};function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":16,_process:14,inherits:10}],18:[function(e,t,r){"use strict";function n(){throw new Error("[logger] Cannot create a CommonTransport object directly")}t.exports=n;n.create=function i(e,t){var r=Object.create(n.prototype);r.init(e,t);return r};n.prototype.init=function o(e,t){Object.defineProperties(this,{logger:{value:e,enumerable:true},monitoring:{value:false,writable:true,enumerable:true},minLevel:{value:0,writable:true,enumerable:true},maxLevel:{value:6,writable:true,enumerable:true},messageFormatter:{value:e.messageFormatter.text,writable:true,enumerable:true},timeFormatter:{value:e.timeFormatter.dateTime,writable:true,enumerable:true}});if(t){this.setConfig(t)}};n.prototype.setConfig=function s(e){if(e.monitoring!==undefined){this.monitoring=!!e.monitoring}if(e.minLevel!==undefined){if(typeof e.minLevel==="number"){this.minLevel=e.minLevel}else if(typeof e.minLevel==="string"){this.minLevel=this.logger.levelHash[e.minLevel]}}if(e.maxLevel!==undefined){if(typeof e.maxLevel==="number"){this.maxLevel=e.maxLevel}else if(typeof e.maxLevel==="string"){this.maxLevel=this.logger.levelHash[e.maxLevel]}}if(e.messageFormatter){if(typeof e.messageFormatter==="function"){this.messageFormatter=e.messageFormatter}else{this.messageFormatter=this.logger.messageFormatter[e.messageFormatter]}}if(e.timeFormatter){if(typeof e.timeFormatter==="function"){this.timeFormatter=e.timeFormatter}else{this.timeFormatter=this.logger.timeFormatter[e.timeFormatter]}}};n.prototype.transport=function a(e,t,r){r()};n.prototype.shutdown=function l(){}},{}],19:[function(e,t,r){"use strict";t.exports={reset:"[0m",bold:"[1m",dim:"[2m",italic:"[3m",underline:"[4m",inverse:"[7m",defaultColor:"[39m",black:"[30m",red:"[31m",green:"[32m",yellow:"[33m",blue:"[34m",magenta:"[35m",cyan:"[36m",white:"[37m",brightBlack:"[90m",brightRed:"[91m",brightGreen:"[92m",brightYellow:"[93m",brightBlue:"[94m",brightMagenta:"[95m",brightCyan:"[96m",brightWhite:"[97m"}},{}],20:[function(e,t,r){"use strict";var n={};t.exports=n;n.toCamelCase=function i(e){if(!e||typeof e!=="string"){return""}return e.replace(/^[\s_-]*([^\s_-]+)|[\s_-]+([^\s_-]?)([^\s_-]*)/g,function(e,t,r,n){if(t){return t.toLowerCase()}if(!r){return""}return r.toUpperCase()+n.toLowerCase()})};n.camelCaseToDashed=function o(e){if(!e||typeof e!=="string"){return""}return e.replace(/^([A-Z])|([A-Z])/g,function(e,t,r){if(t){return t.toLowerCase()}return"-"+r.toLowerCase()})}},{}],21:[function(e,t,r){"use strict";r.regExp=r.regExpPattern=function o(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")};r.regExpReplacement=function s(e){return e.replace(/\$/g,"$$$$")};r.format=function a(e){return e.replace(/%/g,"%%")};r.shellArg=function l(e){return"'"+e.replace(/\'/g,"'\\''")+"'"};var n={"\r":"\\r","\n":"\\n","	":"\\t","":"\\x7f"};r.control=function u(e){return e.replace(/[\x00-\x1f\x7f]/g,function(e){if(n[e]!==undefined){return n[e]}var t=e.charCodeAt(0).toString(16);if(t.length%2){t="0"+t}return"\\x"+t})};var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};r.html=function c(e){return e.replace(/[&<>]/g,function(e){return i[e]})};r.htmlAttr=function f(e){return e.replace(/[&<>"]/g,function(e){return i[e]})};r.htmlSpecialChars=function p(e){return e.replace(/[&<>"']/g,function(e){return i[e]})}},{}],22:[function(e,t,r){"use strict";var n=e("./inspect.js").inspect;var i=e("./inspect.js").inspectError;var o=e("./ansi.js");r.formatMethod=function a(e){if(typeof e!=="string"){if(e===null||e===undefined){return""}else if(typeof e.toString==="function"){e=e.toString()}else{return""}}var t=this,r,o,s=1,a=arguments,l=arguments.length,u=false;e=e.replace(/\^(.?)|(%%)|%([+-]?)([0-9]*)(?:\[([^\]]*)\])?([a-zA-Z])/g,function(e,c,f,p,h,d,g){var b,y,m,v,x,w,k=[];if(f){return"%"}if(c){if(c==="^"){return"^"}if(!t.markup){return""}u=true;return t.markup[c]||""}if(h){h=parseInt(h);if(p){if(p==="+"){h=s+h}else if(p==="-"){h=s-h}}}else{h=s}s++;if(h>=l||h<1){r=undefined}else{r=a[h]}switch(g){case"s":if(r===null||r===undefined){return""}if(typeof r==="string"){return r}if(typeof r==="number"){return""+r}if(typeof r.toString==="function"){return r.toString()}return"";case"f":if(typeof r==="string"){r=parseFloat(r)}if(typeof r!=="number"){return"0"}if(d!==undefined){switch(d[0]){case"p":y=parseInt(d.slice(1),10);if(y>=1){r=r.toPrecision(y)}break;case"f":y=parseInt(d.slice(1),10);r=r.toFixed(y);break}}return""+r;case"d":case"i":if(typeof r==="string"){r=parseInt(r)}if(typeof r==="number"){return""+Math.floor(r)}return"0";case"u":if(typeof r==="string"){r=parseInt(r)}if(typeof r==="number"){return""+Math.max(Math.floor(r),0)}return"0";case"U":if(typeof r==="string"){r=parseInt(r)}if(typeof r==="number"){return""+Math.max(Math.floor(r),1)}return"1";case"x":if(typeof r==="string"){r=parseInt(r)}if(typeof r!=="number"){return"0"}o=""+Math.max(Math.floor(r),0).toString(16);if(o.length%2){o="0"+o}return o;case"h":if(typeof r==="string"){r=parseInt(r)}if(typeof r==="number"){return""+Math.max(Math.floor(r),0).toString(16)}return"0";case"o":if(typeof r==="string"){r=parseInt(r)}if(typeof r==="number"){return""+Math.max(Math.floor(r),0).toString(8)}return"0";case"b":if(typeof r==="string"){r=parseInt(r)}if(typeof r==="number"){return""+Math.max(Math.floor(r),0).toString(2)}return"0";case"I":return n({style:t&&t.color?"color":"none"},r);case"E":return i({style:t&&t.color?"color":"none"},r);case"J":return JSON.stringify(r);case"D":return"";case"F":s--;if(d===undefined){return""}m=d.split(":");v=m[0];x=m[1];if(!v){return""}if(x&&(w=x.match(/%([+-]?)([0-9]*)[a-zA-Z]/g))){for(b=0;b<w.length;b++){p=w[b][1];h=w[b][2];if(h){h=parseInt(h,10);if(p){if(p==="+"){h=s+h}else if(p==="-"){h=s-h}}}else{h=s}s++;if(h>=l||h<1){k[b]=undefined}else{k[b]=a[h]}}}if(!t||!t.fn||typeof t.fn[v]!=="function"){return""}return t.fn[v].apply(t,k);default:return""}});if(u&&this.markupReset&&this.endingMarkupReset){e+=this.markupReset}if(this.extraArguments){for(;s<l;s++){r=a[s];if(r===null||r===undefined){continue}else if(typeof r==="string"){e+=r}else if(typeof r==="number"){e+=r}else if(typeof r.toString==="function"){e+=r.toString()}}}return e};var s={extraArguments:true,endingMarkupReset:true,markupReset:o.reset,markup:{":":o.reset," ":o.reset+" ","-":o.dim,"+":o.bold,_:o.underline,"/":o.italic,"!":o.inverse,b:o.blue,B:o.brightBlue,c:o.cyan,C:o.brightCyan,g:o.green,G:o.brightGreen,k:o.black,K:o.brightBlack,m:o.magenta,M:o.brightMagenta,r:o.red,R:o.brightRed,w:o.white,W:o.brightWhite,y:o.yellow,Y:o.brightYellow}};r.format=r.formatMethod.bind(s);r.format.default=s;r.format.count=function l(e){var t,r,n,i=1,o=0;if(typeof e!=="string"){return 0}var s=/%([+-]?)([0-9]*)(?:\[([^\]]*)\])?([a-zA-EG-Z])/g;while((t=s.exec(e))!==null){n=t[1];r=t[2];if(r){r=parseInt(r,10);if(n){if(n==="+"){r=i+r}else if(n==="-"){r=i-r}}}else{r=i}i++;if(o<r){o=r}}return o};r.format.hasFormatting=function u(e){if(e.search(/\^(.?)|(%%)|%([+-]?)([0-9]*)(?:\[([^\]]*)\])?([a-zA-Z])/)!==-1){return true}else{return false}}},{"./ansi.js":19,"./inspect.js":23}],23:[function(e,t,r){(function(t,n){"use strict";var i=e("tree-kit/lib/extend.js");var o=e("./escape.js");var s=e("./ansi.js");function a(e,t){if(arguments.length<2){t=e;e={}}else if(!e||typeof e!=="object"){e={}}var r={depth:0,ancestors:[]};if(!e.style){e.style=h.none}else if(typeof e.style==="string"){e.style=h[e.style]}if(e.depth===undefined){e.depth=3}if(e.nofunc){e.noFunc=true}if(e.minimal){e.noFunc=true;e.noDescriptor=true;e.noType=true;e.enumOnly=true;e.funcDetails=false;e.proto=false}return l(r,e,t)}function l(e,r,n){var i,s,a,f,p,h,d,g,b,y,m,v,x="",w="",k="",j,A;d=typeof n;b=r.style.tab.repeat(e.depth);if(d==="function"&&r.noFunc){return""}if(e.key!==undefined){if(e.descriptor){k=[];if(!e.descriptor.configurable){k.push("-conf")}if(!e.descriptor.enumerable){k.push("-enum")}if(!e.descriptor.writable){k.push("-w")}if(k.length){k=k.join(" ")}else{k=""}}if(e.keyIsProperty){if(u(e.key)){w='"'+r.style.key(e.key)+'": '}else{w=r.style.key(e.key)+": "}}else{w="["+r.style.index(e.key)+"] "}if(k){k=" "+r.style.type(k)}}g=e.noPre?"":b+w;if(n===undefined){x+=g+r.style.constant("undefined")+k+r.style.nl}else if(n===null){x+=g+r.style.constant("null")+k+r.style.nl}else if(n===false){x+=g+r.style.constant("false")+k+r.style.nl}else if(n===true){x+=g+r.style.constant("true")+k+r.style.nl}else if(d==="number"){x+=g+r.style.number(n.toString())+(r.noType?"":" "+r.style.type("number"))+k+r.style.nl}else if(d==="string"){x+=g+'"'+r.style.string(o.control(n))+'" '+(r.noType?"":r.style.type("string")+r.style.length("("+n.length+")"))+k+r.style.nl}else if(t.isBuffer(n)){x+=g+r.style.inspect(n.inspect())+" "+(r.noType?"":r.style.type("Buffer")+r.style.length("("+n.length+")"))+k+r.style.nl}else if(d==="object"||d==="function"){s=a="";m=false;if(d==="function"){m=true;s=" "+r.style.funcName(n.name?n.name:"(anonymous)");a=r.style.length("("+n.length+")")}y=false;if(Array.isArray(n)){y=true;a=r.style.length("("+n.length+")")}if(!n.constructor){p="(no constructor)"}else if(!n.constructor.name){p="(anonymous)"}else{p=n.constructor.name}p=r.style.constructorName(p);x+=g;if(!r.noType){if(e.forceType){x+=r.style.type(e.forceType)}else{x+=p+s+a+" "+r.style.type(d)+k}if(!m||r.funcDetails){x+=" "}}f=Object.getOwnPropertyNames(n);if(r.sort){f.sort()}v=c(n);if(v!==undefined){x+="=> "+l({depth:e.depth,ancestors:e.ancestors,noPre:true},r,v)}else if(m&&!r.funcDetails){x+=r.style.nl}else if(!f.length&&!r.proto){x+="{}"+r.style.nl}else if(e.depth>=r.depth){x+=r.style.limit("[depth limit]")+r.style.nl}else if(e.ancestors.indexOf(n)!==-1){x+=r.style.limit("[circular]")+r.style.nl}else{x+=(y&&r.noType?"[":"{")+r.style.nl;A=e.ancestors.slice();A.push(n);for(i=0;i<f.length;i++){try{j=Object.getOwnPropertyDescriptor(n,f[i]);if(!j.enumerable&&r.enumOnly){continue}h=!y||!j.enumerable||isNaN(f[i]);if(!r.noDescriptor&&(j.get||j.set)){x+=l({depth:e.depth+1,ancestors:A,key:f[i],keyIsProperty:h,descriptor:j,forceType:"getter/setter"},r,{get:j.get,set:j.set})}else{x+=l({depth:e.depth+1,ancestors:A,key:f[i],keyIsProperty:h,descriptor:r.noDescriptor?undefined:j},r,n[f[i]])}}catch(_){x+=l({depth:e.depth+1,ancestors:A,key:f[i],keyIsProperty:h,descriptor:r.noDescriptor?undefined:j},r,_)}}if(r.proto){x+=l({depth:e.depth+1,ancestors:A,key:"__proto__",keyIsProperty:true},r,n.__proto__)}x+=b+(y&&r.noType?"]":"}")+r.style.nl}}if(e.depth===0){if(r.style==="html"){x=o.html(x)}}return x}r.inspect=a;function u(e){if(!e.length){return true}return false}function c(e){switch(e.constructor.name){case"Date":if(e instanceof Date){return e.toString()+" ["+e.getTime()+"]"}break;case"Set":if(typeof Set==="function"&&e instanceof Set){return Array.from(e)}break;case"Map":if(typeof Map==="function"&&e instanceof Map){return Array.from(e)}break;case"ObjectID":if(e._bsontype){return e.toString()}break}return}function f(e,t){var r="",n,i,o;if(arguments.length<2){t=e;e={}}else if(!e||typeof e!=="object"){e={}}if(!(t instanceof Error)){return}if(!e.style){e.style=h.none}else if(typeof e.style==="string"){e.style=h[e.style]}if(t.stack){n=p(e,t.stack)}i=t.type||t.constructor.name;o=t.code||t.name||t.errno||t.number;r+=e.style.errorType(i)+(o?" ["+e.style.errorType(o)+"]":"")+": ";r+=e.style.errorMessage(t.message)+"\n";if(n){r+=e.style.errorStack(n)+"\n"}return r}r.inspectError=f;function p(e,t){if(arguments.length<2){t=e;e={}}else if(!e||typeof e!=="object"){e={}}if(!e.style){e.style=h.none}else if(typeof e.style==="string"){e.style=h[e.style]}if(!t){return}if((e.browser||n.browser)&&t.indexOf("@")!==-1){t=t.replace(/[<\/]*(?=@)/g,"").replace(/^\s*([^@]*)\s*@\s*([^\n]*)(?::([0-9]+):([0-9]+))?$/gm,function(t,r,n,i,o){return e.style.errorStack("    at ")+(r?e.style.errorStackMethod(r)+" ":"")+e.style.errorStack("(")+(n?e.style.errorStackFile(n):e.style.errorStack("unknown"))+(i?e.style.errorStack(":")+e.style.errorStackLine(i):"")+(o?e.style.errorStack(":")+e.style.errorStackColumn(o):"")+e.style.errorStack(")")})}else{t=t.replace(/^[^\n]*\n/,"");t=t.replace(/^\s*(at)\s+(?:([^\s:\(\)\[\]\n]+)\s)?(?:\[as ([^\s:\(\)\[\]\n]+)\]\s)?(?:\(?([^:\(\)\[\]\n]+):([0-9]+):([0-9]+)\)?)?$/gm,function(t,r,n,i,o,s,a){return e.style.errorStack("    at ")+(n?e.style.errorStackMethod(n)+" ":"")+(i?e.style.errorStack("[as ")+e.style.errorStackMethodAs(i)+e.style.errorStack("] "):"")+e.style.errorStack("(")+(o?e.style.errorStackFile(o):e.style.errorStack("unknown"))+(s?e.style.errorStack(":")+e.style.errorStackLine(s):"")+(a?e.style.errorStack(":")+e.style.errorStackColumn(a):"")+e.style.errorStack(")")})}return t}r.inspectStack=p;var h={};var d=function(e){return e};h.none={tab:"    ",nl:"\n",limit:d,type:function(e){return"<"+e+">"},constant:d,funcName:d,constructorName:function(e){return"<"+e+">"},length:d,key:d,index:d,number:d,inspect:d,string:d,errorType:d,errorMessage:d,errorStack:d,errorStackMethod:d,errorStackMethodAs:d,errorStackFile:d,errorStackLine:d,errorStackColumn:d};h.color=i(null,{},h.none,{limit:function(e){return s.bold+s.brightRed+e+s.reset},type:function(e){return s.italic+s.brightBlack+e+s.reset},constant:function(e){return s.cyan+e+s.reset},funcName:function(e){return s.italic+s.magenta+e+s.reset},constructorName:function(e){return s.magenta+e+s.reset},length:function(e){return s.italic+s.brightBlack+e+s.reset},key:function(e){return s.green+e+s.reset},index:function(e){return s.blue+e+s.reset},number:function(e){return s.cyan+e+s.reset},inspect:function(e){return s.cyan+e+s.reset},string:function(e){return s.blue+e+s.reset},errorType:function(e){return s.red+s.bold+e+s.reset},errorMessage:function(e){return s.red+s.italic+e+s.reset},errorStack:function(e){return s.brightBlack+e+s.reset},errorStackMethod:function(e){return s.brightYellow+e+s.reset},errorStackMethodAs:function(e){return s.yellow+e+s.reset},errorStackFile:function(e){return s.brightCyan+e+s.reset},errorStackLine:function(e){return s.blue+e+s.reset},errorStackColumn:function(e){return s.magenta+e+s.reset}});h.html=i(null,{},h.none,{tab:"&nbsp;&nbsp;&nbsp;&nbsp;",nl:"<br />",limit:function(e){return'<span style="color:red">'+e+"</span>"},type:function(e){return'<i style="color:gray">'+e+"</i>"},constant:function(e){return'<span style="color:cyan">'+e+"</span>"},funcName:function(e){return'<i style="color:magenta">'+e+"</i>"},constructorName:function(e){return'<span style="color:magenta">'+e+"</span>"},length:function(e){return'<i style="color:gray">'+e+"</i>"},key:function(e){return'<span style="color:green">'+e+"</span>"},index:function(e){return'<span style="color:blue">'+e+"</span>"},number:function(e){return'<span style="color:cyan">'+e+"</span>"},inspect:function(e){return'<span style="color:cyan">'+e+"</span>"},string:function(e){return'<span style="color:blue">'+e+"</span>"},errorType:function(e){return'<span style="color:red">'+e+"</span>"},errorMessage:function(e){return'<span style="color:red">'+e+"</span>"},errorStack:function(e){return'<span style="color:gray">'+e+"</span>"},errorStackMethod:function(e){return'<span style="color:yellow">'+e+"</span>"},errorStackMethodAs:function(e){return'<span style="color:yellow">'+e+"</span>"},errorStackFile:function(e){return'<span style="color:cyan">'+e+"</span>"},errorStackLine:function(e){return'<span style="color:blue">'+e+"</span>"},errorStackColumn:function(e){return'<span style="color:gray">'+e+"</span>"}})}).call(this,{isBuffer:e("../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js")},e("_process"))},{"../../browserify/node_modules/insert-module-globals/node_modules/is-buffer/index.js":11,"./ansi.js":19,"./escape.js":21,_process:14,"tree-kit/lib/extend.js":32}],24:[function(e,t,r){t.exports={"":"0","":"","":" ","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"Dh","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OE","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"Th","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c",C:"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dh","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"ff","":"fi","":"fl","":"ffi","":"ffl","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oe","":"oi","":"oo","":"ou","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"ss","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"th","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z"}},{}],25:[function(e,t,r){"use strict";var n=e("./latinize-map.json");t.exports=function(e){return e.replace(/[^\u0000-\u007e]/g,function(e){return n[e]||e})}},{"./latinize-map.json":24}],26:[function(e,t,r){"use strict";var n={};t.exports=n;n.repeat=function(e){if(this===null){throw new TypeError("can't convert "+this+" to object")}var t=""+this;e=+e;if(e!==e){e=0}if(e<0){throw new RangeError("repeat count must be non-negative")}if(e===Infinity){throw new RangeError("repeat count must be less than infinity")}e=Math.floor(e);if(t.length===0||e===0){return""}if(t.length*e>=1<<28){throw new RangeError("repeat count must not overflow maximum string size")}var r="";for(;;){if((e&1)===1){r+=t}e>>>=1;if(e===0){break}t+=t}return r}},{}],27:[function(e,t,r){"use strict";var n=e("./escape.js");r.regexp={};r.regexp.array2alternatives=function i(e){var t,r=e.slice();r.sort(function(e,t){return t.length-e.length});for(t=0;t<r.length;t++){r[t]=n.regExpPattern(r[t])}return r.join("|")}},{"./escape.js":21}],28:[function(e,t,r){"use strict";var n=e("tree-kit");var i={};t.exports=i;var o;var s=e("./polyfill.js");for(o in s){i[o]=function(e){return s[o].apply(e,Array.prototype.slice.call(arguments,1))}}n.extend(null,i,{escape:e("./escape.js")},{ansi:e("./ansi.js")},{unicode:e("./unicode.js")});n.extend(null,i,e("./format.js"),e("./inspect.js"),e("./regexp.js"),e("./camel.js"),{latinize:e("./latinize.js")});i.installPolyfills=function a(){var e;for(e in s){if(!String.prototype[e]){String.prototype[e]=s[e]}}}},{"./ansi.js":19,"./camel.js":20,"./escape.js":21,"./format.js":22,"./inspect.js":23,"./latinize.js":25,"./polyfill.js":26,"./regexp.js":27,"./unicode.js":29,"tree-kit":36}],29:[function(e,t,r){"use strict";var n=e("punycode");var i={};t.exports=i;i.length=function o(e){return n.ucs2.decode(e).length};i.toArray=function s(e){return n.ucs2.decode(e).map(function(e){return n.ucs2.encode([e])})};i.surrogatePair=function a(e){var t=e.charCodeAt(0);if(t<55296||t>=57344){return 0}else if(t<56320){return 1}else{return-1}};i.isFullWidth=function l(e){var t=e.codePointAt(0);if(t>=4352&&(t<=4447||9001===t||9002===t||11904<=t&&t<=12871&&t!==12351||12880<=t&&t<=19903||19968<=t&&t<=42182||43360<=t&&t<=43388||44032<=t&&t<=55203||63744<=t&&t<=64255||65040<=t&&t<=65049||65072<=t&&t<=65131||65281<=t&&t<=65376||65504<=t&&t<=65510||110592<=t&&t<=110593||127488<=t&&t<=127569||131072<=t&&t<=262141)){return true}return false};i.toFullWidth=function u(e){return n.ucs2.encode(n.ucs2.decode(e).map(function(e){if(e>=33&&e<=126){return 65280+e-32}else{return e}}))}},{punycode:15}],30:[function(e,t,r){"use strict";r.clone=function n(e,t){
var r,n,i,o,s,a,l=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],u=l[0].target,c=[e],f=[u];while(o=l.shift()){i=Object.getOwnPropertyNames(o.source);for(r=0;r<i.length;r++){n=Object.getOwnPropertyDescriptor(o.source,i[r]);if(!n.value||typeof n.value!=="object"){Object.defineProperty(o.target,i[r],n);continue}s=n.value;n.value=Array.isArray(s)?[]:Object.create(Object.getPrototypeOf(s));if(t){a=c.indexOf(s);if(a!==-1){n.value=f[a];Object.defineProperty(o.target,i[r],n);continue}c.push(s);f.push(n.value)}Object.defineProperty(o.target,i[r],n);l.push({source:s,target:n.value})}}return u}},{}],31:[function(e,t,r){"use strict";function n(e,t,r){var i,o,s,a,l,u,c,f,p,h,d;u=typeof e;c=typeof t;if(!e||u!=="object"&&u!=="function"||!t||c!=="object"&&c!=="function"){throw new Error("[tree] diff() needs objects as argument #0 and #1")}if(!r||typeof r!=="object"){r={}}f=r.depth||0;if(!f){r.diffObject={};if(!r.path){r.path=""}if(!r.pathSeparator){r.pathSeparator="."}}p=r.diffObject;if(Array.isArray(e)){d=true;h=e.length}else{d=false;a=Object.keys(e);h=a.length}for(i=0;i<h;i++){o=d?i:a[i];s=r.path+r.pathSeparator+o;if(!t.hasOwnProperty(o)){p[s]={path:s,message:"does not exist in right-hand side"};continue}u=typeof e[o];c=typeof t[o];if(u!==c){p[s]={path:s,message:"different typeof: "+u+" - "+c};continue}if(u==="object"||u==="function"){if(!e[o]){if(t[o]){p[s]={path:s,message:"different type: null - Object"}}continue}if(!t[o]){p[s]={path:s,message:"different type: Object - null"};continue}if(Array.isArray(e[o])&&!Array.isArray(t[o])){p[s]={path:s,message:"different type: Array - Object"};continue}if(!Array.isArray(e[o])&&Array.isArray(t[o])){p[s]={path:s,message:"different type: Object - Array"};continue}n(e[o],t[o],{path:s,pathSeparator:r.pathSeparator,depth:f+1,diffObject:p});continue}if(e[o]!==t[o]){p[s]={path:s,message:"different value: "+e[o]+" - "+t[o]};continue}}if(Array.isArray(t)){d=true;h=t.length}else{d=false;l=Object.keys(t);h=l.length}for(i=0;i<h;i++){o=d?i:l[i];s=r.path+r.pathSeparator+o;if(!e.hasOwnProperty(o)){p[s]={path:s,message:"does not exist in left-hand side"};continue}}return Object.keys(p).length?p:null}r.diff=n},{}],32:[function(e,t,r){"use strict";function n(e,t,r){var i,o,s,a,l,u,c,f,p,h,d,g,b=-1,y=false,m=arguments.length;if(!t||typeof t!=="object"){t={}}if(!e){e={depth:0,prefix:""};if(!t.maxDepth&&t.deep&&!t.circular){t.maxDepth=100}if(t.deepFunc){t.deep=true}if(t.deepFilter&&typeof t.deepFilter==="object"){if(t.deepFilter.whitelist&&(!Array.isArray(t.deepFilter.whitelist)||!t.deepFilter.whitelist.length)){delete t.deepFilter.whitelist}if(t.deepFilter.blacklist&&(!Array.isArray(t.deepFilter.blacklist)||!t.deepFilter.blacklist.length)){delete t.deepFilter.blacklist}if(!t.deepFilter.whitelist&&!t.deepFilter.blacklist){delete t.deepFilter}}if(t.flat){t.deep=true;t.proto=false;t.inherit=false;t.unflat=false;if(typeof t.flat!=="string"){t.flat="."}}if(t.unflat){t.deep=false;t.proto=false;t.inherit=false;t.flat=false;if(typeof t.unflat!=="string"){t.unflat="."}}if(t.inherit){t.own=true;t.proto=false}else if(t.proto){t.own=true}if(!r||typeof r!=="object"&&typeof r!=="function"){y=true}if(!t.skipRoot&&(t.inherit||t.proto)){for(i=m-1;i>=3;i--){a=arguments[i];if(a&&(typeof a==="object"||typeof a==="function")){if(t.inherit){if(y){r=Object.create(a)}else{r.__proto__=a}}else if(t.proto){if(y){r=Object.create(a.__proto__)}else{r.__proto__=a.__proto__}}break}}}else if(y){r={}}e.references={sources:[],targets:[]}}if(t.maxDepth&&e.depth>t.maxDepth){throw new Error("[tree] extend(): max depth reached("+t.maxDepth+")")}for(i=3;i<m;i++){a=arguments[i];if(!a||typeof a!=="object"&&typeof a!=="function"){continue}if(t.circular){e.references.sources.push(a);e.references.targets.push(r)}if(t.own){if(t.nonEnum){l=Object.getOwnPropertyNames(a)}else{l=Object.keys(a)}}else{l=a}for(u in l){if(t.own){u=l[u]}if(t.descriptor){p=Object.getOwnPropertyDescriptor(a,u);c=p.value}else{c=a[u]}d=r;h=e.prefix+u;if(t.nofunc&&typeof c==="function"){continue}if(t.unflat&&e.depth===0){g=u.split(t.unflat);s=g.length-1;if(s){for(o=0;o<s;o++){if(!d[g[o]]||typeof d[g[o]]!=="object"&&typeof d[g[o]]!=="function"){d[g[o]]={}}d=d[g[o]]}h=e.prefix+g[s]}}if(t.deep&&c&&(typeof c==="object"||t.deepFunc&&typeof c==="function")&&(!t.descriptor||!p.get)&&(!t.deepFilter||(!t.deepFilter.whitelist||t.deepFilter.whitelist.indexOf(c.__proto__)!==-1)&&(!t.deepFilter.blacklist||t.deepFilter.blacklist.indexOf(c.__proto__)===-1))){if(t.circular){b=e.references.sources.indexOf(c)}if(t.flat){if(b>=0){continue}n({depth:e.depth+1,prefix:e.prefix+u+t.flat,references:e.references},t,d,c)}else{if(b>=0){if(t.descriptor){Object.defineProperty(d,h,{value:e.references.targets[b],enumerable:p.enumerable,writable:p.writable,configurable:p.configurable})}else{d[h]=e.references.targets[b]}continue}if(!d[h]||!d.hasOwnProperty(h)||typeof d[h]!=="object"&&typeof d[h]!=="function"){if(Array.isArray(c)){f=[]}else if(t.proto){f=Object.create(c.__proto__)}else if(t.inherit){f=Object.create(c)}else{f={}}if(t.descriptor){Object.defineProperty(d,h,{value:f,enumerable:p.enumerable,writable:p.writable,configurable:p.configurable})}else{d[h]=f}}else if(t.proto&&d[h].__proto__!==c.__proto__){d[h].__proto__=c.__proto__}else if(t.inherit&&d[h].__proto__!==c){d[h].__proto__=c}if(t.circular){e.references.sources.push(c);e.references.targets.push(d[h])}n({depth:e.depth+1,prefix:"",references:e.references},t,d[h],c)}}else if(t.preserve&&d[h]!==undefined){continue}else if(!t.inherit){if(t.descriptor){Object.defineProperty(d,h,p)}else{d[h]=c}}if(t.move){delete a[u]}}}return r}t.exports=n.bind(undefined,null)},{}],33:[function(e,t,r){"use strict";r.defineLazyProperty=function n(e,t,r){Object.defineProperty(e,t,{configurable:true,enumerable:true,get:function(){var n=r();Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:false,value:n});return n}})}},{}],34:[function(e,t,r){"use strict";var n=e("./tree.js");var i=e("util");var o={};t.exports=o;o.Mask=function a(){throw new Error("Cannot create a tree.Mask() directly")};var s={clone:false,path:"<object>",pathSeparator:"."};o.createMask=function l(e,t){if(e===null||typeof e!=="object"){throw new TypeError("[tree] .createMask() : Argument #1 should be an object")}if(t!==null&&typeof t==="object"){t=n.extend(null,{},s,t)}else{t=s}var r=Object.create(o.Mask.prototype,{__options__:{value:t,writable:true}});n.extend(null,r,e);return r};o.Mask.prototype.applyTo=function u(e,t,r){if(e===null||typeof e!=="object"){throw new TypeError("[tree] .applyTo() : Argument #1 should be an object")}if(r){t=n.extend(null,{mask:this,options:this.__options__,path:this.__options__.path},t)}else if(t===undefined){t={mask:this,options:this.__options__,path:this.__options__.path}}var i,s,a,l,u,c,f=Object.keys(t.mask),p,h,d,g;if(Array.isArray(e)){a=[]}else{a={}}for(l=0;l<f.length;l++){u=f[l];c=t.mask[u];if(u==="*"){g=Object.keys(e);for(p=0;p<g.length;p++){h=g[p];d=e[h];s=t.path+t.options.pathSeparator+h;if(c!==null&&typeof c==="object"){if(e[h]!==null&&typeof e[h]==="object"){if(e[h]instanceof o.Mask){a[h]=e[h].applyTo(e[h],{path:s},true)}else{a[h]=this.applyTo(e[h],n.extend(null,{},t,{mask:c,path:s}))}}else if(typeof t.options.leaf==="function"){a[h]=this.applyTo({},n.extend(null,{},t,{mask:c,path:s}))}}else if(c!==null&&typeof t.options.leaf==="function"){i=t.options.leaf(e,h,c,s);if(!(i instanceof Error)){a[h]=i}}else{if(t.options.clone&&(e[h]!==null&&typeof e[h]==="object")){a[h]=n.extend({deep:true},{},e[h])}else{a[h]=e[h]}}}continue}s=t.path+t.options.pathSeparator+u;if(c!==null&&typeof c==="object"){if(e.hasOwnProperty(u)&&e[u]!==null&&typeof e[u]==="object"){if(e.key instanceof o.Mask){a[u]=e.key.applyTo(e[u],{path:s},true)}else{a[u]=this.applyTo(e[u],n.extend(null,{},t,{mask:c,path:s}))}}else if(t.options.leaf){a[u]=this.applyTo({},n.extend(null,{},t,{mask:c,path:s}))}}else if(e.hasOwnProperty(u)){if(c!==undefined&&typeof t.options.leaf==="function"){i=t.options.leaf(e,u,c,s);if(!(i instanceof Error)){a[u]=i}}else{if(t.options.clone&&(e[u]!==null&&typeof e[u]==="object")){a[u]=n.extend({deep:true},{},e[u])}else{a[u]=e[u]}}}else if(c!==undefined&&typeof t.options.leaf==="function"){i=t.options.leaf(e,u,c,s);if(!(i instanceof Error)){a[u]=i}}}return a};o.InverseMask=function c(){throw new Error("Cannot create a tree.InverseMask() directly")};i.inherits(o.InverseMask,o.Mask);o.createInverseMask=function f(e,t){if(e===null||typeof e!=="object"){throw new TypeError("[tree] .createInverseMask() : Argument #1 should be an object")}if(t!==null&&typeof t==="object"){t=n.extend(null,{},s,t)}else{t=s}var r=Object.create(o.InverseMask.prototype,{__options__:{value:t,writable:true}});n.extend(null,r,e);return r};o.InverseMask.prototype.applyTo=function p(e,t,r){if(e===null||typeof e!=="object"){throw new TypeError("[tree] .applyTo() : Argument #1 should be an object")}if(r){t=n.extend(null,{mask:this,options:this.__options__,path:this.__options__.path},t)}else if(t===undefined){t={mask:this,options:this.__options__,path:this.__options__.path}}var i,s,a,l,u,c=Object.keys(t.mask),f,p,h,d;if(Array.isArray(e)){s=n.extend({deep:true},[],e)}else{s=n.extend({deep:true},{},e)}for(a=0;a<c.length;a++){l=c[a];u=t.mask[l];if(l==="*"){d=Object.keys(e);for(f=0;f<d.length;f++){p=d[f];h=e[p];i=t.path+t.options.pathSeparator+p;if(u!==null&&typeof u==="object"){if(e[p]!==null&&typeof e[p]==="object"){if(e[p]instanceof o.Mask){s[p]=e[p].applyTo(e[p],{path:i},true)}else{s[p]=this.applyTo(e[p],n.extend(null,{},t,{mask:u,path:i}))}}}else{delete s[p]}}continue}i=t.path+t.options.pathSeparator+l;if(u!==null&&typeof u==="object"){if(e.hasOwnProperty(l)&&e[l]!==null&&typeof e[l]==="object"){if(e.key instanceof o.Mask){s[l]=e.key.applyTo(e[l],{path:i},true)}else{s[l]=this.applyTo(e[l],n.extend(null,{},t,{mask:u,path:i}))}}}else if(e.hasOwnProperty(l)){delete s[l]}}return s}},{"./tree.js":36,util:17}],35:[function(e,t,r){"use strict";var n={};t.exports=n;n.op=function i(e,t,r,n){var i,o,s,a,l,u=false,c=false,f;if(typeof r==="string"){o=r.match(/([.#\[\]]|[^.#\[\]]+)/g)}else if(Array.isArray(r)){o=r;c=true}else{throw new TypeError("[tree.path] ."+e+"(): the path argument should be a string or an array")}switch(e){case"get":case"delete":f=false;break;case"set":case"define":case"inc":case"dec":case"append":case"prepend":case"autoPush":f=true;break;default:throw new TypeError("[tree.path] .op(): wrong type of operation '"+e+"'")}a=t;s=o.length-1;for(i=0;i<=s;i++){if(c){if(l===undefined){l=o[i];continue}if(!a[l]||typeof a[l]!=="object"&&typeof a[l]!=="function"){if(!f){return undefined}a[l]={}}a=a[l];l=o[i];continue}else if(o[i]==="."){u=false;if(l===undefined){continue}if(!a[l]||typeof a[l]!=="object"&&typeof a[l]!=="function"){if(!f){return undefined}a[l]={}}a=a[l];continue}else if(o[i]==="#"||o[i]==="["){u=true;if(l===undefined){if(!Array.isArray(a)){return undefined}continue}if(!a[l]||!Array.isArray(a[l])){if(!f){return undefined}a[l]=[]}a=a[l];continue}else if(o[i]==="]"){continue}if(!u){l=o[i];continue}switch(o[i]){case"length":l=o[i];break;case"first":l=0;break;case"last":l=a.length-1;if(l<0){l=0}break;case"next":if(!f){return undefined}l=a.length;break;case"insert":if(!f){return undefined}a.unshift(undefined);l=0;break;default:l=parseInt(o[i],10)}}switch(e){case"get":return a[l];case"delete":if(u&&typeof l==="number"){a.splice(l,1)}else{delete a[l]}return;case"set":a[l]=n;return a[l];case"define":if(!(l in a)){a[l]=n}return a[l];case"inc":if(typeof a[l]==="number"){a[l]++}else if(!a[l]||typeof a[l]!=="object"){a[l]=1}return a[l];case"dec":if(typeof a[l]==="number"){a[l]--}else if(!a[l]||typeof a[l]!=="object"){a[l]=-1}return a[l];case"append":if(!a[l]){a[l]=[n]}else if(Array.isArray(a[l])){a[l].push(n)}return a[l];case"prepend":if(!a[l]){a[l]=[n]}else if(Array.isArray(a[l])){a[l].unshift(n)}return a[l];case"autoPush":if(a[l]===undefined){a[l]=n}else if(Array.isArray(a[l])){a[l].push(n)}else{a[l]=[a[l],n]}return a[l]}};n.get=n.op.bind(undefined,"get");n.delete=n.op.bind(undefined,"delete");n.set=n.op.bind(undefined,"set");n.define=n.op.bind(undefined,"define");n.inc=n.op.bind(undefined,"inc");n.dec=n.op.bind(undefined,"dec");n.append=n.op.bind(undefined,"append");n.prepend=n.op.bind(undefined,"prepend");n.autoPush=n.op.bind(undefined,"autoPush");n.prototype={get:function(e){return n.get(this,e)},"delete":function(e){return n.delete(this,e)},set:function(e,t){return n.set(this,e,t)},define:function(e,t){return n.define(this,e,t)},inc:function(e,t){return n.inc(this,e,t)},dec:function(e,t){return n.dec(this,e,t)},append:function(e,t){return n.append(this,e,t)},prepend:function(e,t){return n.prepend(this,e,t)},autoPush:function(e,t){return n.autoPush(this,e,t)}};n.upgrade=function o(e){Object.defineProperties(e,{get:{value:n.op.bind(undefined,"get",e)},"delete":{value:n.op.bind(undefined,"delete",e)},set:{value:n.op.bind(undefined,"set",e)},define:{value:n.op.bind(undefined,"define",e)},inc:{value:n.op.bind(undefined,"inc",e)},dec:{value:n.op.bind(undefined,"dec",e)},append:{value:n.op.bind(undefined,"append",e)},prepend:{value:n.op.bind(undefined,"prepend",e)},autoPush:{value:n.op.bind(undefined,"autoPush",e)}})}},{}],36:[function(e,t,r){"use strict";var n={};t.exports=n;n.extend=e("./extend.js");n.extend(null,n,e("./lazy.js"),e("./clone.js"),{path:e("./path.js")},e("./diff.js"),e("./mask.js"))},{"./clone.js":30,"./diff.js":31,"./extend.js":32,"./lazy.js":33,"./mask.js":34,"./path.js":35}]},{},[2])(2)});